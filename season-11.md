## ÙØµÙ„ ÛŒØ§Ø²Ø¯Ù‡Ù…: Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø§ÛŒÙ†ØªØ±Ù†ØªÛŒ (Ø¨Ø®Ø´ Ø¯ÙˆÙ…)

### Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ ØªÚ©Ù…ÛŒÙ„ ÙØ±Ø§ÛŒÙ†Ø¯ Ø®Ø±ÛŒØ¯

**Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø§Ø² Ø¢Ù…ÙˆØ²Ø´ ØµØ±ÙØ§ ØªØ¦ÙˆØ±ÛŒ Ø¨ÙˆØ¯Ù‡ Ùˆ Ø®Ø¨Ø±ÛŒ Ø§Ø² Ú©Ø¯ Ø²Ø¯Ù† Ù†ÛŒØ³Øª!**

**ÙØ±Ø§ÛŒÙ†Ø¯ ØªÚ©Ù…ÛŒÙ„ Ø®Ø±ÛŒØ¯ =>** Ú©Ø§Ø±Ø¨Ø± Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø±Ø§ Ú©Ø§Ù…Ù„ Ú©Ø±Ø¯Ù‡ Ùˆ Ø±ÙˆÛŒ Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯ Ú©Ù„ÛŒÚ© Ú©Ø±Ø¯Ù‡Ø› Ø§Ø² Ø§ÛŒÙ†Ø¬Ø§ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ ÙØ±Ø§ÛŒÙ†Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ø±ÙˆØ¹ Ù…ÛŒØ´ÙˆØ¯:

**Ø­Ø§Ù„Ø§ Ø¯Ùˆ Ø­Ø§Ù„Øª ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯:**

**1-** Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ù‚Ø¨Ù„ Ù„Ø§Ú¯ÛŒÙ† Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª.    
**2-** Ú©Ø§Ø±Ø¨Ø± Ù‡Ù†ÙˆØ² Ù„Ø§Ú¯ÛŒÙ† Ù†Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª.

1. **Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ù‚Ø¨Ù„ Ù„Ø§Ú¯ÛŒÙ†  Ú©Ø±Ø¯Ù‡ Ø¨ÙˆØ¯:** ÙˆÙ‚ØªÛŒ Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒÚ©Ù†Ø¯ Ú†Ù†Ø§Ù†Ú†Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ú©Ø§Ù…Ù„ Ø¨Ø§Ø´Ø¯Ø› Ø¨Ù‡ ØµÙØ­Ù‡ ØªØ§ÛŒÛŒØ¯ Ø®Ø±ÛŒØ¯ Ùˆ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒØ´ÙˆØ¯. 

    Ø§Ú¯Ø± Ù‡Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù…Ù„ Ù†ÛŒØ³ØªØŒ Ø§Ø¨ØªØ¯Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ ØªÚ©Ù…ÛŒÙ„ ÙØ±Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ Ø³Ù¾Ø³ Ø¨Ù‡ ØµÙØ­Ù‡ ØªØ§ÛŒÛŒØ¯ Ø®Ø±ÛŒØ¯ Ùˆ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒØ´ÙˆØ¯.

2. **Ú©Ø§Ø±Ø¨Ø± Ù„Ø§Ú¯ÛŒÙ† Ù†Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª:** Ù¾Ø³ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø­ØµÙˆÙ„Ø§Øª ÙˆÙ‚ØªÛŒ Ø±ÙˆÛŒ  Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯ Ú©Ù„ÛŒÚ© Ù…ÛŒÚ©Ù†Ø¯ Ø§Ø² Ú©Ø§Ø±Ø¨Ø± ÛŒÚ© Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒÛŒØ¯ Ø´Ø®Øµ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÛŒÚ©Ù†Ø¯(ÛŒÚ© Ú©Ø¯ Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒØ´ÙˆØ¯.)Ø› 

    **Ø§Ú¯Ø± Ø´Ù…Ø§Ø±Ù‡ Ø§Ø² Ù‚Ø¨Ù„ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯(Ø­Ø³Ø§Ø¨ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯)**Ø› Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ ØªØ§ÛŒÛŒØ¯ Ø®Ø±ÛŒØ¯ Ùˆ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ….

    **Ø§Ú¯Ø± Ø´Ù…Ø§Ø±Ù‡ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø´Øª**Ø› Ø¨Ø±Ø§ÛŒ Ø¢Ù† Ø´Ø®Øµ Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† ÛŒÚ© Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ… Ùˆ Ø³Ù¾Ø³ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ ØªØ§ÛŒÛŒØ¯ Ø®Ø±ÛŒØ¯ Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ….

    - Ø¯Ø± ÛŒÚ© ÙØ±Ù…  Ù…Ø´Ø®ØµØ§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´ Ø±Ø§ Ø§Ø² Ú©Ø§Ø±Ø¨Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒÚ©Ù†ÛŒÙ….

### Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…Ú© Ø¨Ø§ ÙˆØ¨ Ø³Ø±ÙˆÛŒØ³ (Ú©Ø§ÙˆÙ‡ Ù†Ú¯Ø§Ø±)

**Ù†Ú©ØªÙ‡:** Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…Ú© Ø¯Ø± **ÙˆØ¨ Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ù¾ÛŒØ§Ù…Ú©ÛŒ** Ù„Ø§Ø²Ù… Ø§Ø³Øª Ú©Ù‡ Ø¯Ø± Ø¢Ù† ÙˆØ¨Ø³Ø§ÛŒØª Ù‡Ø§ Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø±Ø¯Ù‡ Ùˆ Ù…Ø±Ø§Ø­Ù„ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø±Ø§ ØªÚ©Ù…ÛŒÙ„ Ú©Ù†ÛŒØ¯.

Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ØŒ Ø§Ø·Ù„Ø§Ø¹ Ø±Ø³Ø§Ù†ÛŒ Ù‡Ø§ØŒ ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´ Ø®Ø±ÛŒØ¯Ø§Ø± Ùˆ... Ø§Ø² Ø³Ø±ÙˆÛŒØ³ Ù¾ÛŒØ§Ù…Ú©ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ ÙˆØ¨ Ø³Ø±ÙˆÛŒØ³ Ù¾ÛŒØ§Ù…Ú©ÛŒ Ú©Ø§ÙˆÙ‡ Ù†Ú¯Ø§Ø± Ø±Ø§ Ù…Ø¹Ø±ÙÛŒ Ù…ÛŒÚ©Ù†ÛŒÙ… ÙˆÙ„ÛŒ Ø´Ù…Ø§ Ù…ÛŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² ÙˆØ¨ Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯Ø› Ú†ÙˆÙ† Ø³Ø§Ø®ØªØ§Ø± Ùˆ Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ ØªÙ‚Ø±ÛŒØ¨Ø§ Ù…Ø´Ø§Ø¨Ù‡ ÛŒÚ©Ø¯ÛŒÚ¯Ø± Ù…ÛŒØ¨Ø§Ø´Ø¯.

**1-** Ø¯Ø± Ù…Ø±Ø­Ù„Ù‡ Ø§ÙˆÙ„ Ù„Ø§Ø²Ù… Ø§Ø³Øª Ø«Ø¨Øª Ù†Ø§Ù… Ùˆ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø±Ø§Ø› Ú©Ù‡ Ø¯Ø± ÙˆØ¨Ø³Ø§ÛŒØª Ø³Ø±ÙˆÛŒØ³ Ù¾ÛŒØ§Ù…Ú©ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒÙ….

**2-** Ø¯Ø± Ø¨Ø®Ø´ ***Ø­Ø³Ø§Ø¨ Ù…Ù†*** ÛŒÚ© API Key ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ØŒ Ú©Ù‡ Ø¯Ø± Ú©Ø¯Ù‡Ø§ Ø¨Ù‡ Ø¢Ù† Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒÙ…. / Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø¢ÛŒÚ©ÙˆÙ† Ú©Ù„ÛŒØ¯ (ğŸ”‘)  ÛŒÚ© API Ø¬Ø¯ÛŒØ¯ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†Ø¯(API Ù‚Ø¨Ù„ÛŒ Ù…Ù†Ù‚Ø¶ÛŒ Ù…ÛŒØ´ÙˆØ¯.)

**Ù¾ÛŒØ§Ù…Ú© Ù‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ÛŒ Ø¯Ùˆ Ø­Ø§Ù„Øª Ø¯Ø§Ø±Ù†Ø¯:**

1- Ù¾ÛŒØ§Ù…Ú© Ù‡Ø§ÛŒ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ ÛŒØ§ Ø¯Ø§Ø±Ø§ÛŒ ÛŒÚ© Ú©Ù„Ù…Ù‡ Ø®Ø§Øµ(Ù¾ÛŒØ§Ù…Ú© Ù‡Ø§ÛŒ ØªÙˆÚ©Ù† Ø¯Ø§Ø±)    
2- Ù¾ÛŒØ§Ù…Ú© Ø¹Ø§Ø¯ÛŒ (Ø´Ø§Ù…Ù„ ÛŒÚ© Ù…ØªÙ† Ø³Ø§Ø¯Ù‡)

**Ù†Ú©ØªÙ‡:** Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ Ø³Ø§Ø®ØªØ§Ø± Ù¾ÛŒØ§Ù…Ú© Ù‡Ø§ÛŒ ØªÙˆÚ©Ù† Ø¯Ø§Ø± Ø¯Ø± Ø¨Ø®Ø´ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø³Ø±ÙˆÛŒØ³ Ù¾ÛŒØ§Ù…Ú©ÛŒ (Ú©Ø§ÙˆÙ‡ Ù†Ú¯Ø§Ø±) Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒØ´ÙˆØ¯.

[![verification-SMS](https://res.cloudinary.com/am-er/image/upload/v1724505875/kavenegar-client-Verification_ewem5f.png)](https://res.cloudinary.com/am-er/image/upload/v1724505875/kavenegar-client-Verification_ewem5f.png)

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

1- Ø§Ø² Ø¨Ø®Ø´ **ØªØ¹Ø±ÛŒÙ Ø§Ù„Ú¯ÙˆÛŒ Ø§Ø¹ØªØ¨Ø§Ø± Ø³Ù†Ø¬ÛŒ**ØŒ Ù…ÛŒØªÙˆØ§Ù†ÛŒÙ… ÛŒÚ© Ù¾ÛŒØ§Ù…Ú© ØªÙˆÚ©Ù† Ø¯Ø§Ø± Ø¬Ø¯ÛŒØ¯ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒÙ….

2- **Ù†Ø§Ù… Ø§Ù„Ú¯Ùˆ**Ø› Ø§Ø³Ù… ØªÙ…Ù¾Ù„ÛŒØª Ù‡Ø³Øª Ú©Ù‡ Ø¯Ø± Ø³Ø§Ø®ØªØ§Ø± Ú©Ø¯ Ø§Ø² Ø¢Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

3- Ù…ØªÙ†ÛŒ Ú©Ù‡ Ù‚Ø±Ø§Ø± Ø§Ø³Øª Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§Ø±Ø³Ø§Ù„ Ø´ÙˆØ¯ Ø¯Ø± **Ù…ØªÙ† Ø§Ù„Ú¯ÙˆÛŒ Ù¾ÛŒØ§Ù…Ú©** Ù†ÙˆØ´ØªÙ‡ Ù…ÛŒØ´ÙˆØ¯.

> <span class="rtl-text">Ø¨Ø®Ø´ Ù…ØªØºÛŒØ± Ù…Ø­ØªÙˆØ§ÛŒ Ù…ØªÙ† Ù…Ø§Ø› <span class="en-text">%token</span> Ù…ÛŒØ¨Ø§Ø´Ø¯ Ú©Ù‡ Ø¯Ø± view Ø¬Ù†Ú¯Ùˆ Ø¢Ù†Ø±Ø§ Ù…Ù‚Ø¯Ø§Ø± Ø¯Ù‡ÛŒ Ù…ÛŒÚ©Ù†ÛŒÙ….</span>

**Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø³Ø±ÙˆÛŒØ³ Ù¾ÛŒØ§Ù…Ú©ÛŒ Ú©Ø§ÙˆÙ‡ Ù†Ú¯Ø§Ø± Ù„Ø§Ø²Ù… Ø§Ø³Øª Ú©Ù‡ Ú©Ø§Ø¨Ø®Ø§Ù†Ù‡ Ø¢Ù†Ø±Ø§ Ù†ØµØ¨ Ú©Ù†ÛŒÙ….**

`Terminal`

```terminal
pip install kavenegar
```

**Ø³Ø§Ø®ØªØ§Ø± Ù¾ÛŒØ§Ù…Ú© Ù‡Ø§ÛŒ ØªÙˆÚ©Ù† Ø¯Ø§Ø± Ùˆ Ø¹Ø§Ø¯ÛŒ:**

Ø§ÙˆÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ§Ù…Ú© Ù‡Ø§ÛŒ ØªÙˆÚ©Ù† Ø¯Ø§Ø± Ùˆ Ø¯ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ§Ù…Ú© Ù‡Ø§ÛŒ Ø¹Ø§Ø¯ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒØ´ÙˆØ¯.

`app directory(cart)/commom/KaveSms.py`

```python
from kavenegar import *
from urllib.error import HTTPError


def send_sms_with_template(receptor, tokens: dict, template):
    """
        sending sms that needs template
    """
    try:
        api = KavenegarAPI('Ø¯Ø± Ø¨Ø®Ø´ Ø­Ø³Ø§Ø¨ Ù…Ù† API Key')

        params = {
            'receptor': receptor,
            'template': template,
        }

        for key, value in tokens.items():
            params[key] = value

        response = api.verify_lookup(params)
        print(response)
        return True
    except APIException as e:
        print(e)
        return False
    except HTTPError as e:
        print(e)
        return False


# ---------------------------------------
def send_sms_normal(receptor, message):
    try:
        api = KavenegarAPI('Ø¯Ø± Ø¨Ø®Ø´ Ø­Ø³Ø§Ø¨ Ù…Ù† API Key')

        params_buyer = {
            'receptor': receptor,
            'message': message,
            'sender': '10005000505077'
        }

        response = api.sms_send(params_buyer)
        print(response)
    except APIException as e:
        print(e)
    except HTTPError as e:
        print(e)
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

Ø¨Ø±Ø§ÛŒ Ø±Ø§Ø­ØªÛŒ Ú©Ø¯Ù‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø± Ø¨Ù‡ ØµÙˆØ±Øª ØªØ§Ø¨Ø¹ Ù†ÙˆØ´ØªÙ‡ Ùˆ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¢Ù†Ù‡Ø§ Ø¯Ø± view ØªØ§Ø¨Ø¹ Ù…Ø¯Ù†Ø¸Ø± Ø±Ø§ ØµØ¯Ø§ Ù…ÛŒØ²Ù†ÛŒÙ…ØŒ ØªØ§ Ø§Ø² ØªÚ©Ø±Ø§Ø± Ú©Ø¯ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø´ÙˆØ¯.

1- Ø¯Ø± ØªØ§Ø¨Ø¹ **send_sms_with_template**:

- **receptor** => Ø´Ù…Ø§Ø±Ù‡ Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ù¾ÛŒØ§Ù… Ù…ÛŒØ¨Ø§Ø´Ø¯(Ù…Ø´ØªØ±ÛŒØ§Ù† Ùˆ Ø®Ø±ÛŒØ¯Ø§Ø±Ø§Ù† ÙØ±ÙˆØ´Ú¯Ø§Ù‡)

- **tokens** => ÛŒÚ© Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒØŒ Ø´Ø§Ù…Ù„ Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…Ø­ØªÙˆØ§ÛŒ Ù…ØªÙ† Ù…ÛŒØ¨Ø§Ø´Ø¯ (Ù…Ø«Ø§Ù„: {'token': 254168})

- **template** => Ù‡Ù…Ø§Ù†  **Ù†Ø§Ù… Ø§Ù„Ú¯Ùˆ** Ù…ÛŒØ¨Ø§Ø´Ø¯Ø› Ú©Ù‡ Ø¯Ø± Ø¨Ø®Ø´ **ØªØ¹Ø±ÛŒÙ Ø§Ù„Ú¯ÙˆÛŒ Ø§Ø¹ØªØ¨Ø§Ø± Ø³Ù†Ø¬ÛŒ** Ø¢Ù†Ø±Ø§ ØªØ¹Ø±ÛŒÙ Ú©Ø±Ø¯Ù‡ Ø§ÛŒÙ….

> <span class="rtl-text">Ø¯Ø± Ø§ÛŒÙ† Ø­Ø§Ù„Øª Ø¯ÛŒÚ¯Ø± Ù„Ø§Ø²Ù… Ù†ÛŒØ³Øª Ù…ØªÙ†ÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒÙ… Ùˆ ÙÙ‚Ø· Ù…Ù‚Ø¯Ø§Ø± ØªÙˆÚ©Ù† Ù‡Ø§ Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ…ØŒ ØªØ§ Ø¯Ø± Ù…Ø­ØªÙˆØ§ÛŒ Ù…ØªÙ† Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¨Ø¬Ø§ÛŒ (<span class="en-text">%token</span>) Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡ Ùˆ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø§Ø±Ø³Ø§Ù„ Ø´ÙˆØ¯.</span>

2- Ø¯Ø± ØªØ§Ø¨Ø¹ **send_sms_normal**:

- **receptor** => Ø´Ù…Ø§Ø±Ù‡ Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ù¾ÛŒØ§Ù… Ù…ÛŒØ¨Ø§Ø´Ø¯(Ù…Ø´ØªØ±ÛŒØ§Ù† Ùˆ Ø®Ø±ÛŒØ¯Ø§Ø±Ø§Ù† ÙØ±ÙˆØ´Ú¯Ø§Ù‡)

- **message** => Ù…Ø­ØªÙˆØ§ÛŒ Ù…ØªÙ† Ù¾ÛŒØ§Ù….

**Ø§ÛŒÙ† Ú©Ø¯ Ù‡Ø§ Ø±Ø§ Ø¯Ø± ÙØ§ÛŒÙ„ KaveSms.py Ù†ÙˆØ´ØªÙ‡ Ùˆ Ø¢Ù†Ø±Ø§ Ø¯Ø± Ø§Ù¾ cart Ù‚Ø±Ø§Ø± Ù…ÛŒØ¯Ù‡ÛŒÙ….**

> Ø­Ø§Ù„ Ù‡Ø±Ø¬Ø§ Ù†ÛŒØ§Ø² Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒÙ…ØŒ ÛŒÚ©ÛŒ Ø§Ø² ØªÙˆØ§Ø¨Ø¹ Ø¢Ù†Ø±Ø§ Ø§ÛŒÙ…Ù¾ÙˆØ±Øª Ú©Ø±Ø¯Ù‡ Ùˆ Ø¢Ø±Ú¯ÙˆÙ…Ø§Ù† Ù‡Ø§ Ø±Ø§ Ø¨Ø±Ø§ÛŒØ´ Ù…Ø´Ø®Øµ Ù…ÛŒÚ©Ù†ÛŒÙ….

### Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Ø¨Ø±

Ø¯Ø± Ø§Ù¾ orders ÙØ§ÛŒÙ„ urls.py Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ø¯Ø± Ø¢Ù† Ø³Ù‡ url Ù…ÛŒØ³Ø§Ø²ÛŒÙ…Ø›**  
1- Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†   
2- Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø¯ ØªØ§ÛŒÛŒØ¯    
3- Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´

`app directory(orders)/urls.py`

```python
from django.urls import path
from . import views


app_name = 'orders'

urlpatterns = [
    path('verify-phone', views.verify_phone, name='verify_phone'),
    path('verify-code', views.verify_code, name='verify_code'),
    path('order-create', views.order_create, name='order_create'),
]
```

**Ù…Ø¹Ø±ÙÛŒ Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø¨Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡:**

`project directory/urls.py`

```python
urlpatterns = [
    # ...
    path('order/', include('orders.urls', namespace='orders')),
]
```

**Ù†Ú©ØªÙ‡:** Ø¯Ø± Ø§Ù¾ cart Ø¨Ø±Ø§ÛŒ ØªÙ…Ù¾Ù„ÛŒØª Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ØŒ ÛŒÚ© Ø¯Ú©Ù…Ù‡ Ø¨Ø±Ø§ÛŒ **Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯** Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯Ù‡ Ø¨ÙˆØ¯ÛŒÙ…ØŒ Ø­Ø§Ù„Ø§ Ø¨Ø±Ø§ÛŒ href Ø¢Ù† url (Ø¢Ø¯Ø±Ø³) verify-phone Ø±Ø§ Ù…Ø´Ø®Øµ Ù…ÛŒÚ©Ù†ÛŒÙ….

> Ø¨Ø±Ø§ÛŒ Ø±Ø§Ø­ØªÛŒ Ú©Ø¯ Ù‡Ø§ÛŒ Ø·ÙˆÙ„Ø§Ù†ÛŒ Ø±Ø§ collapse Ú©Ø±Ø¯ÛŒÙ….(Ø¨Ø³ØªÛŒÙ…)

`app(cart)/templates/cart/cart_detail.html`

```jinja
{% extends 'parent/base/base_template.html' %}
{% load static %}

{% block title %}products{% endblock %}

{% block content %}
    <div class="header">
        <h1>Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</h1>
    </div>

    <div class="cart-content">
>       {% for item in cart ... %}


>       <div class="cart-total-price"...>


        <div class="checkout-button">
            <div class="continue-btn"><a href="{% url 'orders:verify_phone' %}">Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯</a></div>
            <div class="back-btn"><a href="{% url "shop:products-list" %}">Ø¨Ø±Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª</a></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

>    <script...>
       
{% endblock %}
```

Ø¯Ø± Ø§Ù¾ order ÙØ§ÛŒÙ„ forms.py Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ø± Ø¢Ù† ÛŒÚ© ÙØ±Ù… Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ú©Ø§Ø±Ø¨Ø± Ùˆ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¢Ù† Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

`app directory(orders)/forms.py`

```python
class PhoneVerificationForm(forms.Form):
    phone_number = forms.CharField(max_length=11)

    def clean_phone_number(self):
        phone_number = self.cleaned_data['phone_number']

        # conditions....
        if not phone_number.isdigit():
            raise forms.ValidationError("Phone number must be digit")

        if len(phone_number) != 11:
            raise forms.ValidationError("Phone number must be 11 digits")

        if not phone_number.startswith("09"):
            raise forms.ValidationError("Phone number must start with 09")
        
        return phone_number
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

Ù¾Ø³ Ø§Ø² Ø§ÛŒØ¬Ø§Ø¯ ÙÛŒÙ„Ø¯ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†ØŒ Ø¨Ø±Ø§ÛŒ Ø¢Ù† Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒØ¯Ù‡ÛŒÙ….

1- Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø¹Ø¯Ø¯ Ø¨Ø§Ø´Ø¯.

2- ØªØ¹Ø¯Ø§Ø¯ Ø§Ø±Ù‚Ø§Ù… Ø¢Ù† Ø¨Ø§ÛŒØ¯ 11 ØªØ§ Ø¨Ø§Ø´Ø¯.

3- Ø¨Ø§ÛŒØ¯ Ø¨Ø§ 09 Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯.

Ù†Ù‡Ø§ÛŒØªØ§ Ø§Ú¯Ø± Ù…Ø´Ú©Ù„ÛŒ Ù†Ø¯Ø§Ø´Øª Ø¢Ù†Ø±Ø§ return Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ø§ÛŒØ¬Ø§Ø¯ view Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†:**

`app directory(orders)/views.py`

```python
from django.shortcuts import render, redirect
from django.contrib import messages
from .forms import *
from cart.common.KaveSms import *
import random


# Create your views here.
def verify_phone(request):
    if request.user.is_authenticated:
        return redirect('orders:order_create')
    # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    if request.method == 'POST':
        form = PhoneVerificationForm(request.POST)
        if form.is_valid():
            phone = form.cleaned_data.get('phone_number')

            # verification code
            code = ''.join(random.sample('0123456789', 6))
            tokens = {'token': code}

            # save in session...
            request.session['verification_code'] = code
            request.session['phone'] = phone

            # send SMS
            send_sms_with_template(phone, tokens, 'verification_code')

            # success message
            messages.success(request, 'Your verification code has been sent.')
            return redirect('orders:verify_code')
    else:
        form = PhoneVerificationForm()

    context = {
        'form': form,
    }

    return render(request, 'forms/verify_phone.html', context=context)
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

> Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± ÙˆØ¨Ø³Ø§ÛŒØª Ù„Ø§Ú¯ÛŒÙ† Ú©Ø±Ø¯Ù‡ Ø¨Ø§Ø´Ø¯ (ÛŒØ¹Ù†ÛŒ anonymous-user Ù†Ø¨Ø§Ø´Ø¯)Ø› Ù…ØªØ¯ is_authenticated Ù…Ù‚Ø¯Ø§Ø± True Ø±Ø§ Ø¨Ø±Ù…ÛŒÚ¯Ø±Ø¯Ø§Ù†Ø¯.

1- Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ù„Ø§Ú¯ÛŒÙ† Ú©Ø±Ø¯Ù‡ Ø¨Ø§Ø´Ø¯ØŒ Ø¯ÛŒÚ¯Ø± Ù„Ø§Ø²Ù… Ù†ÛŒØ³Øª Ú©Ù‡ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† ÙˆØ§Ø±Ø¯ Ú©Ù†Ø¯Ø› Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ† Ø¢Ù† Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´ (ÛŒØ¹Ù†ÛŒ order_create) Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ….

2- ÙˆÙ‚ØªÛŒ Ú©Ø§Ø±Ø¨Ø± Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯ Ùˆ Ø¢Ù†Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯ØŒ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø±Ø§ Ø¨Ù‡ ÙØ±Ù… Ù…ÛŒÙØ±Ø³ØªÛŒÙ… ØªØ§ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø´ÙˆØ¯Ø› Ú†Ù†Ø§Ù†Ú†Ù‡ Ù…Ø´Ú©Ù„ÛŒ Ù†Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯ Ø¢Ù†Ø±Ø§ Ø¯Ø± ÛŒÚ© Ù…ØªØºÛŒØ± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

3- Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ random ÛŒÚ© Ú©Ø¯ 6 Ø±Ù‚Ù…ÛŒ(ØªØ¹Ø¯Ø§Ø¯ Ø§Ø±Ù‚Ø§Ù… Ø¯Ù„Ø®ÙˆØ§Ù‡ Ø§Ø³Øª) Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ… Ùˆ Ø¢Ù†Ø±Ø§ Ø¯Ø± ÛŒÚ© Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

> Ø§ÛŒÙ† Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒ Ø±Ø§ Ø¨Ù‡ API Ø³Ø±ÙˆÛŒØ³ Ù¾ÛŒØ§Ù…Ú©ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ…ØŒ ØªØ§ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¢Ù† Ù…Ù‚Ø¯Ø§Ø±ØŒ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø±Ø§ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø§Ø±Ø³Ø§Ù„ Ú©Ù†Ø¯.

4- Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ùˆ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø±Ø§ Ø¯Ø± session Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….(ØªØ§ Ø¯Ø± view Ù‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ù‡Ù… Ø¨Ù‡ Ø¢Ù†Ù‡Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒÙ….)

5- Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ú©Ø§Ø±Ø¨Ø±ØŒ Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒ tokens Ùˆ Ø§Ø³Ù… ØªÙ…Ù¾Ù„ÛŒØª(Ù‡Ù…Ø§Ù† Ù†Ø§Ù… Ø§Ù„Ú¯Ùˆ Ø¯Ø± Ø¨Ø®Ø´ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ¨Ø³Ø§ÛŒØª) Ø±Ø§ Ø¨Ù‡ API  Ø³Ø§Ù…Ø§Ù†Ù‡ Ù¾ÛŒØ§Ù…Ú©ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ…. / Ø³Ø§Ù…Ø§Ù†Ù‡ Ù¾ÛŒØ§Ù…Ú©ÛŒ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¢Ù†Ù‡Ø§ Ù¾ÛŒØ§Ù… Ø±Ø§ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒÚ©Ù†Ø¯.

6- Ù¾ÛŒØ§Ù… "Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯" Ø±Ø§ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ø§Ú˜ÙˆÙ„ messages Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù†Ø´Ø§Ù† Ù…ÛŒØ¯Ù‡ÛŒÙ…. / Ø¯Ø± Ù¾Ø§ÛŒØ§Ù† Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ù‡ view Ø¨Ø¹Ø¯ÛŒ ÛŒØ¹Ù†ÛŒ verify-code Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ø§ÛŒØ¬Ø§Ø¯ ØªÙ…Ù¾Ù„ÛŒØª verify_phone.html**

`app (order)/templates/forms/verify_phone.html`

```jinja
<h2>verification phone</h2>

<form action="" method="post">
    {% csrf_token %}

    {{ form.as_p }}

    <input type="submit" value="Send">
</form>

{% for message in messages %}
	{{ message }}
{% endfor %}
```

### Ø§Ø±Ø³Ø§Ù„ Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø¨Ù‡ Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Ø¨Ø±

Ø¨Ø±Ø§ÛŒ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ ÙÙ‚Ø· Ø¯Ø± ØªÙ…Ù¾Ù„ÛŒØª ÛŒÚ© ÙØ±Ù… Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¢Ù† Ø±Ø§ Ø¨Ø§ Ø¯Ø³ØªÙˆØ± **request.POST** Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ø§ÛŒØ¬Ø§Ø¯ view Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯:**

`app directory(orders)/views.py`

```python
def verify_code(request):
    if request.method == 'POST':
        received_code = request.POST.get('code')
        if received_code:
            verification_code = request.session['verification_code']
            phone = request.session['phone']

            if received_code == verification_code:
                if ShopUser.objects.filter(phone=phone).exists():
                    user = ShopUser.objects.get(phone=phone)
                else:
                    characters = 'QWERTYUIOPASDFGHJKLZXCVBNM-0123456789-@_qwertyuiopasdfghjklzxcvbnm'
                    user_password = ''.join(random.sample(characters, 8))

                    user = ShopUser.objects.create_user(phone=phone)
                    user.set_password(user_password)
                    user.save()

                    # send SMS:
                    send_data = {
                        'token1': phone,
                        'token2': user_password,
                    }
                    send_sms_with_template(phone, send_data, 'create-account')

                # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” login user in website â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
                login(request, user)

                # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” clean code & phone from session â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
                del request.session['verification_code']
                del request.session['phone']

                return redirect('orders:order_create')

            else:
                messages.error(request, 'Your verification code does not match.')

    return render(request, 'forms/verify_code.html')
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

1- ÙˆÙ‚ØªÛŒ Ú©Ø§Ø±Ø¨Ø± Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯ØŒ Ø¨Ø§ Ø¯Ø³ØªÙˆØ± **request.POST.get('code')** Ø¢Ù†Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ø± ÛŒÚ© Ù…ØªØºÛŒØ± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

2- Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ùˆ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ú©Ø§Ø±Ø¨Ø±ØŒ Ø±Ø§ Ø§Ø² session Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ø± Ù…ØªØºÛŒØ± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

3- Ø­Ø§Ù„Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ù‡ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ÛŒ Ú©Ù‡ Ù…Ø§ Ø¨Ø±Ø§ÛŒØ´ Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯ÛŒÙ… ØªØ·Ø§Ø¨Ù‚ Ø¯Ø§Ø±Ø¯ ÛŒØ§ Ù†Ù‡!!!

- Ø§Ú¯Ø± Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ ØªØ·Ø§Ø¨Ù‚ Ù†Ø¯Ø§Ø´Øª ÛŒÚ© Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù†Ø´Ø§Ù† Ù…ÛŒØ¯Ù‡ÛŒÙ…. "Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ ØµØ­ÛŒØ­ Ù†Ù…ÛŒØ¨Ø§Ø´Ø¯ ÛŒØ§ ØªØ·Ø§Ø¨Ù‚ Ù†Ø¯Ø§Ø±Ø¯."

- Ø­Ø§Ù„Ø§ Ø§Ú¯Ø± Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø¯Ø±Ø³Øª Ø¨ÙˆØ¯Ø› Ø¯Ùˆ Ø­Ø§Ù„Øª ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ ØŒ Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø­Ø³Ø§Ø¨ Ù†Ø¯Ø§Ø±Ø¯ ÛŒÚ© Ø­Ø³Ø§Ø¨ Ø¨Ø±Ø§ÛŒØ´ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ… Ùˆ Ø¨Ø§ Ø¢Ù† Ù„Ø§Ú¯ÛŒÙ† Ù…ÛŒÚ©Ù†ÛŒÙ… ÙˆÙ„ÛŒ Ø§Ú¯Ø± Ø­Ø³Ø§Ø¨ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯ Ø¨Ø§ Ù‡Ù…Ø§Ù† Ø­Ø³Ø§Ø¨ Ù„Ø§Ú¯ÛŒÙ† Ù…ÛŒØ´ÙˆÛŒÙ….

4- Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† ÙˆØ¬Ùˆ Ø¯Ø§Ø±Ø¯ ÛŒØ§ Ù†Ù‡! Ø§Ú¯Ø± ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¢Ù† Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¯Ø± ÛŒÚ© Ù…ØªØºÛŒØ± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ… ØªØ§ Ø¨ØªÙˆØ§Ù†ÛŒÙ… Ù„Ø§Ú¯ÛŒÙ† Ø´ÙˆÛŒÙ….

5- Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø´ØªØ› ÛŒÚ© Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø§ Ø±Ù…Ø² Ø±Ù†Ø¯ÙˆÙ… Ø¨Ø±Ø§ÛŒØ´ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¢Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª (Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ(Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†) Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±) Ø±Ø§ Ø¨Ø±Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…Ú© Ù…ÛŒÚ©Ù†ÛŒÙ….

6- Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¯Ø± ÙˆØ¨Ø³Ø§ÛŒØª Ù„Ø§Ú¯ÛŒÙ† Ù…ÛŒÚ©Ù†ÛŒÙ….

7- Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ùˆ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø±Ø§ Ø§Ø² session Ù¾Ø§Ú© Ú©Ø±Ø¯Ù‡ Ùˆ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ ØªÚ©Ù…ÛŒÙ„ ÙØ±Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´(order-create) Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ø§ÛŒØ¬Ø§Ø¯ ØªÙ…Ù¾Ù„ÛŒØª Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø¯ ØªØ§ÛŒÛŒØ¯:**

`app (order)/templates/forms/verify_code.html`

```jinja
<h2>verification code</h2>

<form action="" method="post">
    {% csrf_token %}

    <input type="text" name="code" placeholder="Enter your code">

    <input type="submit" value="send">
</form>

{% for message in messages %}
	{{ message }}
{% endfor %}
```

### Ø¯Ø±ÛŒØ§ÙØª Ù…Ø´Ø®ØµØ§Øª Ø³ÙØ§Ø±Ø´ Ø§Ø² Ú©Ø§Ø±Ø¨Ø±

Ø¯Ø± Ø§Ù¾ orderØŒ Ø¯Ùˆ Ù…Ø¯Ù„ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯ÛŒÙ…Ø› Order(Ø§Ø·Ù„Ø§Ø¹Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´)ØŒ OrderItem(Ø¢ÛŒØªÙ… Ù‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ Ù‡Ù…Ø§Ù† Ú©Ø§Ù„Ø§Ù‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡)

> Ø­Ø§Ù„Ø§ ÛŒÚ© ÙØ±Ù… Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´ Ø±Ø§ Ø§Ø² Ú©Ø§Ø±Ø¨Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒÚ©Ù†Ø¯ Ùˆ Ù¾Ø³ Ø§Ø² Ø¢Ù† Ø¨Ø±Ø§Ø³Ø§Ø³ Ø§Ø·Ù„Ø§Ø¹Ø§Øª cart(Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯) Ø¢Ø¨Ø¬Ú©Øª Ù‡Ø§ÛŒ Ù…Ø¯Ù„ OrderItem Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ø§ÛŒØ¬Ø§Ø¯ ÙØ±Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´:**

`app directory(orders)/forms.py`

```python
from django import forms
from .models import Order


class OrderCreateForm(forms.ModelForm):
    class Meta:
        model = Order
        fields = ['firstname', 'lastname', 'phone', 'address', 'postal_code', 'province', 'city']
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

ÙØ±Ù… Ø±Ø§ Ø§Ø² ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…Ø¯Ù„ Order Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ù†Ú©ØªÙ‡:** Ø¯Ø± Ø§ÛŒÙ† ÙØ±Ù… Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø±Ø§ Ù†ÛŒØ² Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒÚ©Ù†ÛŒÙ…ØŒ Ú†ÙˆÙ† Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´ Ù…ÛŒØ¨Ø§Ø´Ø¯ Ùˆ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù‡Ù…Ø§Ù† Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù†Ø¨Ø§Ø´Ø¯.(Ø´Ù…Ø§Ø±Ù‡ Ø§ÛŒ Ú©Ù‡ Ø¨Ø§ Ø¢Ù† Ù„Ø§Ú¯ÛŒÙ† Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª.)

**Ø§ÛŒØ¬Ø§Ø¯ view Ø¨Ø±Ø§ÛŒ ÙØ±Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´:**

Ø§ÛŒÙ† view Ø¨Ù‡ url (Ø¢Ø¯Ø±Ø³) order-create Ù…ØªØµÙ„ Ù…ÛŒØ¨Ø§Ø´Ø¯.

`app directory(orders)/views.py`

```python
from django.contrib.auth.decorators import login_required
from django.shortcuts import render, redirect
from .forms import *
from .models import OrderItem, Order
from cart.cart import Cart
# app "cart" => "cart.py" file => "Cart" class


@login_required
def order_create(request):
    cart = Cart(request)

    if request.method == 'POST':
        form = OrderCreateForm(request.POST)
        if form.is_valid():
            # Order Info
            order = form.save(commit=False)
            order.buyer = request.user
            order.save()

            # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Order Item â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
            for item in cart:
                OrderItem.objects.create(
                    order=order,
                    product=item['product'],
                    price=item['price'],
                    quantity=item['quantity'],
                    weight=item['weight'],
                )
            # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

            # clean cart
            cart.clear()
            request.session['order_id'] = order.id

            # Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ù‡ ØµÙØ­Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù‡Ø²ÛŒÙ†Ù‡ Ø³ÙØ§Ø±Ø´
            return redirect('orders:request')
    else:
        form = OrderCreateForm()

    return render(request, 'forms/order_create.html', {'form': form, 'cart': cart})
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

1- Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† view Ø§Ø² Ø¯Ú©ÙˆØ±Ø§ØªÙˆØ± **login_required** Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ…Ø› Ú†ÙˆÙ† Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† ØµÙØ­Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ÛŒØ¯ Ø¯Ø± ÙˆØ¨Ø³Ø§ÛŒØª Ù„Ø§Ú¯ÛŒÙ† Ú©Ø±Ø¯Ù‡ Ø¨Ø§Ø´Ø¯.

2- ÛŒÚ© Ø¢Ø¨Ø¬Ú©Øª Ø§Ø² Ú©Ù„Ø§Ø³ Cart Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ…. / Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¢Ù† Ø¢Ø¨Ø¬Ú©Øª Ù‡Ø§ÛŒ OrderItem Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

3- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´ Ø±Ø§ Ø§ ØªÙ…Ù¾Ù„ÛŒØª Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ùˆ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¢Ù†Ø±Ø§ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù…ÛŒÚ©Ù†ÛŒÙ….

4- Ú†Ù†Ø§Ù†Ú†Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ù…Ø´Ú©Ù„ÛŒ Ù†Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù†Ø¯ØŒ Ø¨Ø§ Ù…ØªØ¯ save Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙØ§Ø±Ø´ Ø±Ø§ Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

5- Ø±ÙˆÛŒ Ø¢Ø¨Ø¬Ú©Øª cart Ø­Ù„Ù‚Ù‡ Ù…ÛŒØ²Ù†ÛŒÙ… Ùˆ Ø¨Ø±Ø§Ø³Ø§Ø³ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¢Ù†ØŒ Ø¨Ø±Ø§ÛŒ Ù…Ø¯Ù„ OrderItem Ø¢Ø¨Ø¬Ú©Øª Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø³ÙØ§Ø±Ø´ ÙØ¹Ù„ÛŒ Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

> ÙˆÙ‚ØªÛŒ Ø±ÙˆÛŒ Ø¢Ø¨Ø¬Ú©Øª cart Ø­Ù„Ù‚Ù‡ Ù…ÛŒØ²Ù†ÛŒÙ…ØŒ Ø¯Ø± Ù‡Ø± Ø§ÛŒØªØ±ÛŒØ´Ù† ÛŒÚ© Ù…Ø­ØµÙˆÙ„ Ø§Ø² Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø¨Ø§ Ø§Ø·Ù„Ø§Ø¹Ø§ØªÛŒ Ù†Ø¸ÛŒØ± ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ù„Ø§ØŒ Ù‚ÛŒÙ…Øª Ú©Ø§Ù„Ø§ØŒ Ùˆ... Ø±Ø§ Ø¨Ø±Ù…ÛŒÚ¯Ø±Ø¯Ø§Ù†Ø¯.
>
> Ù‡Ø± item ÛŒÚ© Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒ Ø§Ø² Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„ Ù…ÛŒØ¨Ø§Ø´Ø¯. / Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ù‡Ø± Ø¢ÛŒØªÙ… ÛŒÚ© Ø¢Ø¨Ø¬Ú©Øª Ø¨Ø±Ø§ÛŒ Ù…Ø¯Ù„ OrderItem Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

6- Ø§Ø·Ù„Ø§Ø¹Ø§Øª cart (Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯) Ø±Ø§ Ø¨Ø§ Ù…ØªØ¯ clear Ù¾Ø§Ú© Ù…ÛŒÚ©Ù†ÛŒÙ….

7- Ø¢ÛŒØ¯ÛŒ Ø³ÙØ§Ø±Ø´ (order_id) Ø±Ø§ Ø¯Ø± session Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ…. / Ø¯Ø± view Ù‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒØ´ÙˆØ¯.

8- Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒÚ©Ù†ÛŒÙ…. / Ø¯Ø± Ø§Ø¯Ø§Ù…Ù‡ url Ùˆ view Ø¢Ù†Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ø§ÛŒØ¬Ø§Ø¯ ØªÙ…Ù¾Ù„ÛŒØª ÙØ±Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯ÛŒØ±Ù†Ø¯Ù‡ Ø³ÙØ§Ø±Ø´:**

`app(orders)/templates/forms/order_create.html`

```jinja
<h2>Your chosen products</h2>

<ul>
    {% for item in cart %}
        <li>
            {{ item.quantity }} X {{ item.product.name }} =>
            {{ item.total }}
        </li>
    {% endfor %}
</ul>

<!-- â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” -->

<h2>Complete the order information</h2>

<form action="" method="post">
    {% csrf_token %}
    
    {{ form.as_p }}

    <input type="submit" value="send">
</form>
```

### Ø§ØªØµØ§Ù„ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª (Ø²Ø±ÛŒÙ† Ù¾Ø§Ù„) Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡

Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®ØªØŒ Ø¯Ø± Ø¢Ù† ÙˆØ¨Ø³Ø§ÛŒØª Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø±Ø¯Ù‡ Ùˆ Ø¹Ù…Ù„ÛŒØ§Øª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø±Ø§ ØªÚ©Ù…ÛŒÙ„ Ù…ÛŒÚ©Ù†ÛŒÙ….

Ù„Ø§Ø²Ù… Ø§Ø³Øª ÛŒÚ©Ø³Ø±ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø±Ø§ Ø¯Ø± **settings.py** Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ú©Ù†ÛŒÙ…:

`project directory/settings.py`

```python
# ZarinPal Info
MERCHANT = "00000000-0000-0000-0000-000000000000"
SANDBOX = False
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

- ÙˆÙ‚ØªÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø±Ø¯ÛŒÙ…ØŒ ØªÙˆÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÛŒÚ© Ú©Ø¯ Ø¨Ø±Ø§ÛŒ Ù…Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒØ´ÙˆØ¯Ø› Ø¢Ù†Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù…ØªØºÛŒØ± MERCHANT Ø³Øª Ù…ÛŒÚ©Ù†ÛŒÙ…. / Ø§ÛŒÙ† Ù…Ù‚Ø¯Ø§Ø± ÙØ¹Ù„ÛŒ Ø³Ø§Ø®ØªØ§Ø± Ø¢Ù†Ø±Ø§ Ù†Ø´Ø§Ù† Ù…ÛŒØ¯Ù‡Ø¯.

- Ø¨Ø±Ø§ÛŒ SANDBOX Ù…Ù‚Ø¯Ø§Ø± False Ø±Ø§ Ù…Ø´Ø®Øµ Ù…ÛŒÚ©Ù†ÛŒÙ…Ø› ØªØ§ Ø§Ø² ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´ÙØ±Ø¶ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†Ø¯.

> Ø¯Ø± ØµÙˆØ±Øª Ù†Ø¨ÙˆØ¯ Ù…Ø§Ú˜ÙˆÙ„ **requests** Ø¢Ù†Ø±Ø§ Ù†ØµØ¨ Ù…ÛŒÚ©Ù†ÛŒÙ….
>
> pip install requests

**Ø§ÛŒØ¬Ø§Ø¯ url Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª:**

Ø¯Ùˆ ØªØ§ url Ø¨Ù‡ url Ù‡Ø§ÛŒ Ø§Ù¾ orders Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

`app directory(orders)/urls.py`

```python
urlpatterns = [
    # ...
    path('request/', views.send_request, name='request'),
    path('verify/', views.verify, name='verify'),
]
```

> view Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø§ÛŒÙ† Ø¯Ùˆ url  Ø±Ø§ Ù‡Ù… Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….
>
> Ø§ÙˆÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±Ø§Ø­Ù„ Ù‚Ø¨Ù„ Ø§Ø² ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù‡Ø³Øª Ùˆ Ø¯ÛŒÚ¯Ø±ÛŒ Ù…Ø±Ø§Ø­Ù„ Ø¨Ø¹Ø¯ Ø§Ø² Ø§ÛŒÙ†Ú©Ù‡ Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø±Ù…ÛŒÚ¯Ø±Ø¯Ø¯.

**Ø§ÛŒØ¬Ø§Ø¯ view Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª:**

Ø§ÛŒÙ† Ø¯Ø§Ø¯Ù‡ Ù‡Ø§ Ø±Ø§ Ø§Ø² Ú¯ÛŒØªÙ‡Ø§Ø¨ÛŒ Ú©Ù‡ Ø¯Ø± Ø³Ø§ÛŒØª Ø²Ø±ÛŒÙ† Ù¾Ø§Ù„ Ú¯ÙØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø±Ù…ÛŒØ¯Ø§Ø±ÛŒÙ…Ø› ÙˆÙ„ÛŒ Ø³Ø§Ø®ØªØ§Ø± Ø¢Ù†Ù‡Ø§ Ø§ÛŒØ±Ø§Ø¯Ø§ØªÛŒ Ø¯Ø§Ø±Ù‡ Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ† Ø§Ø² Ù†Ø³Ø®Ù‡ ÙˆÛŒØ±Ø§ÛŒØ´ Ø´Ø¯Ù‡ Ø¯Ø± pull request Ø¢Ù†  Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ù‡ Ø¢Ù† Ù‡Ù… Ø¨Ø§Ø² Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØºÛŒÛŒØ±Ø§ØªÛŒ Ø¯Ø§Ø±Ø¯.

`github(zarinpal)`

```python
from django.conf import settings
from django.shortcuts import redirect
from django.http import HttpResponse
import requests
import json


#? sandbox merchant 
if settings.SANDBOX:
    sandbox = 'sandbox'
else:
    sandbox = 'www'


ZP_API_REQUEST = f"https://{sandbox}.zarinpal.com/pg/rest/WebGate/PaymentRequest.json"
ZP_API_VERIFY = f"https://{sandbox}.zarinpal.com/pg/rest/WebGate/PaymentVerification.json"
ZP_API_STARTPAY = f"https://{sandbox}.zarinpal.com/pg/StartPay/"

amount = 1000  # Rial / Required
description = "ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ ØªØ±Ø§Ú©Ù†Ø´ Ø±Ø§ Ø¯Ø± Ø§ÛŒÙ† Ù‚Ø³Ù…Øª ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"  # Required
phone = 'YOUR_PHONE_NUMBER'  # Optional
# Important: need to edit for real server.
CallbackURL = 'http://127.0.0.1:8080/verify/'


def send_request(request):
    data = {
        "MerchantID": settings.MERCHANT,
        "Amount": amount,
        "Description": description,
        "Phone": phone,
        "CallbackURL": CallbackURL,
    }
    data = json.dumps(data)
    # set content length by data
    headers = {'accept': 'application/json', 'content-type': 'application/json', 'content-length': str(len(data))}
    try:
        response = requests.post(ZP_API_REQUEST, data=data, headers=headers, timeout=10)

        if response.status_code == 200:
            response_json = response.json()
            authority = response_json['Authority']
            if response_json['Status'] == 100:
                return redirect(ZP_API_STARTPAY+authority)
            else:
                return HttpResponse('Error')
        return HttpResponse('response failed')
    except requests.exceptions.Timeout:
        return HttpResponse('Timeout Error')
    except requests.exceptions.ConnectionError:
        return HttpResponse('Connection Error')


def verify(request):
    authority = request.GET.get('Authority')
    status = request.GET.get('Status')
    if status == 'OK' and authority:
        data = {
            "MerchantID": settings.MERCHANT,
            "Amount": amount,
            "Authority": authority,
        }
        data = json.dumps(data)
        # set content length by data
        headers = {'accept': 'application/json', 'content-type': 'application/json', 'content-length': str(len(data))}
        try:
            response = requests.post(ZP_API_VERIFY, data=data, headers=headers)
            if response.status_code == 200:
                response_json = response.json()
                reference_id = response_json['RefID']
                if response['Status'] == 100:
                    return HttpResponse(f'successful , RefID: {reference_id}')
                else:
                    return HttpResponse('Error')
            return HttpResponse('response failed')
        except requests.exceptions.Timeout:
            return HttpResponse('Timeout Error')
        except requests.exceptions.ConnectionError:
            return HttpResponse('Connection Error')
    else:
        return HttpResponse('Not ok')
```

**Ø¨Ø±ÛŒÙ… Ø§ÛŒÙ† Ø¯Ùˆ ØªØ§ view Ø±Ø§ ØªØºÛŒÛŒØ± Ø¨Ø¯ÛŒÙ…:**

1- amount, description, phone Ù…Ù‚Ø¯Ø§Ø± Ø«Ø§Ø¨Øª Ù†Ø¯Ø§Ø±Ù†Ø¯ Ù¾Ø³ Ø¢Ù†Ù‡Ø§ Ø±Ø§ Ø¯Ø± view Ù‡Ø§ ØªØ¹Ø±ÛŒÙ Ù…ÛŒÚ©Ù†ÛŒÙ… Ù†Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª ÛŒÚ© Ù…ØªØºÛŒØ±.

2- Ø¨Ø±Ø§ÛŒ CallbackURL Ø¨Ø§ÛŒØ¯ Ø¢Ø¯Ø±Ø³ Ø­Ù‚ÛŒÙ‚ÛŒ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒÙ… ÙˆÙ„ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø§Ø² Ø¢Ø¯Ø±Ø³ local-host Ø¨Ø§ Ù¾ÙˆØ±Øª 8000 Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

> <span class="rtl-text">**Ù†Ú©ØªÙ‡:** Ø§Ú¯Ø± ÛŒØ§Ø¯ØªØ§Ù† Ø¨Ø§Ø´Ø¯ Ø¯Ø± ÙØ§ÛŒÙ„ urls.py Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ url Ù‡Ø§ÛŒ Ø§Ù¾ order Ù…Ø´Ø®Øµ Ú©Ø±Ø¯ÛŒÙ… Ú©Ù‡ Ø¨Ø§ Ø¹Ø¨Ø§Ø±Øª <span class="en-text">order/</span> Ø´Ø±ÙˆØ¹ Ø´ÙˆÙ†Ø¯ Ø¯Ø± Ù†ØªÛŒØ¬Ù‡ Ø¨Ø§ÛŒØ¯ order Ø±Ø§ Ù‚Ø¨Ù„ Ø§Ø² verify Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒÙ….</span>
>
> <span class="rtl-text">Ù¾Ø³ Ø§ÛŒÙ†Ø¬Ø§ url Ù…Ø§ Ù…ÛŒØ´ÙˆØ¯ <span class="en-text">http://127.0.0.1:8000/order/verify/</span></span>

**Ø§ÛŒØ¬Ø§Ø¯ ØªØºÛŒÛŒØ±Ø§Øª Ø¯Ø± ÙˆÛŒÙˆÛŒ send_request:**

1- Ù…Ù‚Ø§Ø¯ÛŒØ± Ù„Ø§Ø²Ù… Ø±Ø§ Ø§Ø² Ø¢Ø¨Ø¬Ú©Øª Ø³ÙØ§Ø±Ø´ ÙØ¹Ù„ÛŒ Ù…ÛŒÚ¯ÛŒØ±ÛŒÙ…Ø› Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ† Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¢ÛŒØ¯ÛŒ Ø³ÙØ§Ø±Ø´ (order_id) Ú©Ù‡ Ø¯Ø± view Ù‚Ø¨Ù„ÛŒ Ø¯Ø± Ø³Ø´Ù† Ø°Ø®ÛŒØ±Ù‡ Ú©Ø±Ø¯ÛŒÙ… Ø¢Ø¨Ø¬Ú©Øª Ø³ÙØ§Ø±Ø´ Ø±Ø§ Ø§Ø² Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒÚ©Ù†ÛŒÙ….

2- Ø¨Ø±Ø§ÛŒ ØªÙˆØ¶ÛŒØ­Ø§Øª Ø³ÙØ§Ø±Ø´ Ø§Ø³Ù… Ù…Ø­ØµÙˆÙ„Ø§Øª Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù‡ Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒØ¯Ù‡ÛŒÙ…./ Ø±ÙˆÛŒ order-item Ù‡Ø§ÛŒ Ø§ÛŒÙ† Ø³ÙØ§Ø±Ø´ Ø­Ù„Ù‚Ù‡ Ù…ÛŒØ²Ù†ÛŒÙ… Ùˆ Ø§Ø³Ù… Ù…Ø­ØµÙˆÙ„ Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø±Ø´ØªÙ‡ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

3- **Amount:** Ù‡Ø²ÛŒÙ†Ù‡ Ù†Ù‡Ø§ÛŒÛŒ Ø¬Ù‡Øª Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÛŒØ¨Ø§Ø´Ø¯(Ù‡Ø²ÛŒÙ†Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª + Ù‡Ø²ÛŒÙ†Ù‡ Ù¾Ø³ØªÛŒ)Ø› Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…ØªØ¯ <span class="en-text">get_final_cost()</span> Ø¨Ø±Ø§ÛŒ Ø¢Ø¨Ø¬Ú©Øª order Ø¢Ù†Ø±Ø§ Ø¨Ø¯Ø³Øª Ù…ÛŒ Ø¢ÙˆØ±ÛŒÙ….

4- Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø®Ø±ÛŒØ¯Ø§Ø± Ø±Ø§ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¯Ø³ØªÙˆØ± request.user.phone Ù…Ø´Ø®Øµ Ù…ÛŒÚ©Ù†ÛŒÙ….

**Ø§ÛŒØ¬Ø§Ø¯ ØªØºÛŒÛŒØ±Ø§Øª Ø¯Ø± ÙˆÛŒÙˆÛŒ verify:**

1- Ø¯Ø± Ø§ÛŒÙ† view Ù‡Ù… Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² order_id Ø¢Ø¨Ø¬Ú©Øª Ø³ÙØ§Ø±Ø´ ÙØ¹Ù„ÛŒ Ø±Ø§ Ø¯Ø± ÛŒÚ© Ù…ØªØºÛŒØ± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

2- Ù…Ù‚Ø¯Ø§Ø± **Amount** Ø±Ø§ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…ØªØ¯ <span class="en-text">get_final_cost()</span> Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

3- <span class="rtl-text"> Ø´Ø±Ø· `if response['Status'] == 100` Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ `if response_json['Status'] == 100` ØªØºÛŒÛŒØ± Ú©Ù†Ø¯.</span>

4- ÙˆÙ‚ØªÛŒ Ú©Ø¯ ÙˆØ¶Ø¹ÛŒØª 100 Ù‡Ø³ØªØ› ÛŒØ¹Ù†ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯Ù‡ Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ† Ø¨Ø§ÛŒØ¯ **Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¢Ù† Ù…Ø­ØµÙˆÙ„Ø§Øª** Ùˆ Ù†ÛŒØ² **ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ø±Ø¨Ø±** ØªØºÛŒÛŒØ± Ú©Ù†Ø¯.

```python
if response_json['Status'] == 100:
    # change inventory of products
    for item in order.items.all():
        item.product.inventory -= item.quantity
        item.product.save()

    # change paid status...
    order.paid = True
    order.save()
```

**Ù†Ø³Ø®Ù‡ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡ view Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª:**

Ø¯Ø± Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ ØªØºÛŒÛŒØ±Ø§ØªÛŒ Ú©Ù‡ Ø¯Ø± Ø¨Ø§Ù„Ø§ ØªÙˆØ¶ÛŒØ­ Ø¯Ø§Ø¯ÛŒÙ… Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯Ù‡ Ø§Ù†Ø¯.

`app directory(orders)/views.py`

```python
# zarin pal info : Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª

# ? sandbox merchant
if settings.SANDBOX:
    sandbox = 'sandbox'
else:
    sandbox = 'www'


ZP_API_REQUEST = f"https://{sandbox}.zarinpal.com/pg/rest/WebGate/PaymentRequest.json"
ZP_API_VERIFY = f"https://{sandbox}.zarinpal.com/pg/rest/WebGate/PaymentVerification.json"
ZP_API_STARTPAY = f"https://{sandbox}.zarinpal.com/pg/StartPay/"


# Important: need to edit for real server.
CallbackURL = 'http://127.0.0.1:8000/order/verify/'


def send_request(request):
    order = get_object_or_404(Order, id=request.session.get('order_id'))

    description = ""
    for item in order.items.all():
        description += item.product.name + ', '

    data = {
        "MerchantID": settings.MERCHANT,
        "Amount": order.get_final_cost(),
        "Description": description,
        "Phone": request.user.phone,
        "CallbackURL": CallbackURL,
    }

    data = json.dumps(data)
    # set content length by data
    headers = {'accept': 'application/json', 'content-type': 'application/json', 'content-length': str(len(data))}
    try:
        response = requests.post(ZP_API_REQUEST, data=data, headers=headers, timeout=10)

        if response.status_code == 200:
            response_json = response.json()
            authority = response_json['Authority']
            if response_json['Status'] == 100:
                return redirect(ZP_API_STARTPAY+authority)
            else:
                return HttpResponse('Error')
        return HttpResponse('response failed')
    except requests.exceptions.Timeout:
        return HttpResponse('Timeout Error')
    except requests.exceptions.ConnectionError:
        return HttpResponse('Connection Error')


def verify(request):
    order = get_object_or_404(Order, id=request.session.get('order_id'))

    data = {
        "MerchantID": settings.MERCHANT,
        "Amount": order.get_final_cost(),
        "Authority": request.GET.get('Authority'),
    }
    data = json.dumps(data)
    # set content length by data
    headers = {'accept': 'application/json', 'content-type': 'application/json', 'content-length': str(len(data))}
    try:
        response = requests.post(ZP_API_VERIFY, data=data, headers=headers)
        if response.status_code == 200:
            response_json = response.json()
            reference_id = response_json['RefID']
            if response_json['Status'] == 100:
                for item in order.items.all():
                    item.product.inventory -= item.quantity
                    item.product.save()

                # change paid status...
                order.paid = True
                order.save()

                return HttpResponse(f'successful , RefID: {reference_id}')
            else:
                return HttpResponse('Error')

        # clean Order-Id from session
        del request.session['order_id']

        return HttpResponse('response failed')
    except requests.exceptions.Timeout:
        return HttpResponse('Timeout Error')
    except requests.exceptions.ConnectionError:
        return HttpResponse('Connection Error')
```

### ØµÙØ­Ø§Øª ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®ØªØŒ Ù„ÛŒØ³Øª Ùˆ Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙØ§Ø±Ø´

Ø¨Ø±Ø§ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ø±Ø¨Ø±(Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚ Ùˆ ÛŒØ§ Ø²Ù…Ø§Ù†ÛŒÚ©Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ Ø´Ú©Ø³Øª Ù…ÙˆØ§Ø¬Ù‡ Ù…ÛŒØ´ÙˆØ¯) ÛŒÚ© ØªÙ…Ù¾Ù„ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ…. / Ø§ÛŒÙ† ØªÙ…Ù¾Ù„ÛŒØª Ø¨Ø¬Ø§ÛŒ HttpResponse Ø¯Ø± ÙˆÛŒÙˆÛŒ verify Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒØ´ÙˆØ¯.

**Ø§Ø¹Ù…Ø§Ù„ ØªØºÛŒÛŒØ±Ø§Øª Ø¯Ø± ÙˆÛŒÙˆÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ verify:**

`app directory(orders)/views.py`

```python
def verify(request):
    order = get_object_or_404(Order, id=request.session.get('order_id'))

    data = {
        "MerchantID": settings.MERCHANT,
        "Amount": order.get_final_cost(),
        "Authority": request.GET.get('Authority'),
    }
    data = json.dumps(data)
    # set content length by data
    headers = {'accept': 'application/json', 'content-type': 'application/json', 'content-length': str(len(data))}
    try:
        response = requests.post(ZP_API_VERIFY, data=data, headers=headers)
        if response.status_code == 200:
            response_json = response.json()
            reference_id = response_json['RefID']
            if response_json['Status'] == 100:
                for item in order.items.all():
                    item.product.inventory -= item.quantity
                    item.product.save()

                # change paid status...
                order.paid = True
                order.save()

                return render(request, 'orders/payment-tracking.html', {'success': True, 'RefID': reference_id, 'order_id': order.id})
            else:
                return render(request, 'orders/payment-tracking.html', {'success': False})

        # clean Order-Id from session
        del request.session['order_id']

        return HttpResponse('response failed')
    except requests.exceptions.Timeout:
        return HttpResponse('Timeout Error')
    except requests.exceptions.ConnectionError:
        return HttpResponse('Connection Error')
```

**Ø§ÛŒØ¬Ø§Ø¯ ØªÙ…Ù¾Ù„ÛŒØª ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ø±Ø¨Ø±:**

`app(orders)/templates/orders/payment-tracking.html`

```jinja
{% extends 'parent/base/base_template.html' %}

{% load static %}
{% block title %}payment{% endblock %}

{% block content %}
	{% if success %}
        <div class="success">
            <h2>Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚</h2>

            <p>Ø´Ù…Ø§Ø±Ù‡ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ: {{ RefID }}</p>
            <p>Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´: {{ order_id }}</p>
        </div>

    {% else %}
        <div class="failure">
            <h2>Ù¾Ø±Ø¯Ø§Ø®Øª Ù†Ø§Ù…ÙˆÙÙ‚</h2>
            <p>Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ Ø´Ú©Ø³Øª Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯.</p>
        </div>
	{% endif %}

    <a href="{% url 'shop:products-list' %}" class="back-btn">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª</a>
{% endblock %}
```

**Ø§ÛŒØ¬Ø§Ø¯ url  Ø¨Ø±Ø§ÛŒ ØµÙØ­Ø§Øª (Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª Ùˆ Ø¬Ø²Ø¦ÛŒØ§Øª Ù‡Ø± Ø³ÙØ§Ø±Ø´):**

`app directory(orders)/urls.py`

```python
urlpatterns = [
    # ...
    path('orders-list/', views.orders_list, name='orders_list'),
    path('order-detail/<int:order_id>/', views.order_detail, name='order_detail'),
]
```

**Ø§ÛŒØ¬Ø§Ø¯ view  Ø¨Ø±Ø§ÛŒ ØµÙØ­Ø§Øª (Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª Ùˆ Ø¬Ø²Ø¦ÛŒØ§Øª Ù‡Ø± Ø³ÙØ§Ø±Ø´):**

`app directory(orders)/views.py`

```python
def orders_list(request):
    user = request.user
    orders = Order.objects.filter(buyer=user)

    context = {
        'orders': orders,
    }

    return render(request, 'orders/order_list.html', context=context)

# â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

def order_detail(request, order_id):
    order = get_object_or_404(Order, id=order_id)
    order_items = OrderItem.objects.filter(order=order)

    context = {
        'order': order,
        'order_items': order_items,
    }

    return render(request, 'orders/order_detail.html', context=context)
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

1- Ø¯Ø± view Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§ØªØŒ ØªÙ…Ø§Ù… Ø³ÙØ§Ø±Ø´Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø§ Ø§Ø² Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ø± ÛŒÚ© Ù…ØªØºÛŒØ± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ…Ø› Ø¢Ù†Ø±Ø§ Ø¨Ù‡ ØªÙ…Ù¾Ù„ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø­Ù„Ù‚Ù‡ Ø³ÙØ§Ø±Ø´Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¯Ø± Ø¢Ù† ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒØ¯Ù‡ÛŒÙ….

2- Ø¯Ø± view  Ø¬Ø²Ø¦ÛŒØ§Øª Ù‡Ø± Ø³ÙØ§Ø±Ø´ØŒ Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ø¢ÛŒØ¯ÛŒ Ø³ÙØ§Ø±Ø´ØŒ Ø¢Ù† Ø³ÙØ§Ø±Ø´ Ø±Ø§ Ø§Ø² Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒÚ©Ù†ÛŒÙ…Ø› Ø¢ÛŒØªÙ… Ù‡Ø§ÛŒ Ø¢Ù† Ø³ÙØ§Ø±Ø´ Ø±Ø§ Ù‡Ù… Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒÚ©Ù†ÛŒÙ… ØªØ§ Ø¢Ù†Ù‡Ø§ Ø±Ø§ Ø¯Ø± ØªÙ…Ù¾Ù„ÛŒØª Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‡ÛŒÙ….

**Ø§ÛŒØ¬Ø§Ø¯ ØªÙ…Ù¾Ù„ÛŒØª Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª Ú©Ø§Ø±Ø¨Ø±:**

`app(orders)/templates/orders/order_list.html`

```jinja
{% extends 'parent/base/base_template.html' %}

{% load static %}
{% block title %}order's list{% endblock %}

{% block content %}
    <h1>Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª</h1>

    {% if orders %}
    	<table>
            <thead>
                <tr>
                    <th>Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´</th>
                    <th>ØªØ§Ø±ÛŒØ® Ø³ÙØ§Ø±Ø´</th>
                    <th>ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´</th>
                </tr>
            </thead>

            <tbody>
                {% for order in orders %}
                    <tr>
                        <td><a href="{% url 'orders:order_detail' order.id %}">{{ order.id }}</a></td>

                        <td>{{ order.created }}</td>

                        {% if order.paid %}
                            <td>Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚ âœ”ï¸</td>
                        {% else %}
                            <td>Ù¾Ø±Ø¯Ø§Ø®Øª Ù†Ø§Ù…ÙˆÙÙ‚ âœ–ï¸</td>
                        {% endif %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>

    {% else %}
        Ù‡ÛŒÚ† Ø³ÙØ§Ø±Ø´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª!
    {% endif %}

{% endblock %}
```

**Ø§ÛŒØ¬Ø§Ø¯ ØªÙ…Ù¾Ù„ÛŒØª Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¬Ø²Ø¦ÛŒØ§Øª Ù‡Ø± Ø³ÙØ§Ø±Ø´:**

`app(orders)/templates/orders/order_detail.html`

```jinja
{% extends 'parent/base/base_template.html' %}

{% load static %}
{% block title %}order detail{% endblock %}

{% block content %}
    <h1>Ø³ÙØ§Ø±Ø´ {{ order.id }}</h1>

    <h2>order item's</h2>
    <div class="products">
        {% for order_item in order_items %}
            <div class="product">
                <img src="{{ order_item.product.images.first.image_file.url }}" alt="" width="150px">
                <h3>{{ order_item.product.name }}</h3>

                <span>{{ order_item.quantity }} X {{ order_item.price }} => {{ order_item.get_cost }}</span>
            </div>
            <hr>
        {% endfor %}
        
    </div>

    <hr>

    <div class="info">
        <h2>order info</h2>

        <p>first name: {{ order.firstname }}</p>
        <p>last name: {{ order.lastname }}</p>
        <p>phone: {{ order.phone }}</p>

        <p>province: {{ order.province }}</p>
        <p>city: {{ order.city }}</p>
        <p>full address: {{ order.address }}</p>
        <p>postal code: {{ order.postal_code }}</p>
    </div>
{% endblock %}
```

### Ù‚Ø§Ø¨Ù„ÛŒØª Ø®Ø±ÙˆØ¬ÛŒ ÙØ§ÛŒÙ„ Excel Ø§Ø² Ø³ÙØ§Ø±Ø´ Ù‡Ø§ Ø¯Ø± Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ†

Ù…ÛŒØ®ÙˆØ§Ù‡ÛŒÙ… Ø§Ú©Ø´Ù†ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒÙ… Ú©Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙØ§Ø±Ø´ Ù‡Ø§ Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Excel Ø¯Ø± Ø®Ø±ÙˆØ¬ÛŒ ØªØ­ÙˆÛŒÙ„ Ø¯Ù‡Ø¯.

> Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú©Ø§Ø± Ù„Ø§Ø²Ù… Ø§Ø³Øª Ú©Ù‡ Ù¾Ú©ÛŒØ¬ **openpyxl** Ø±Ø§ Ù†ØµØ¨ Ú©Ù†ÛŒÙ….

`terminal`

```terminal
pip install openpyxl
```

**Ø¨Ø±ÛŒÙ… Ø§Ú©Ø´Ù† Ø±Ø§ Ø¯Ø± ÙØ§ÛŒÙ„ admin.py Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒÙ…:**

Ù„Ø§Ø²Ù… Ø§Ø³Øª Ú©Ù‡ HttpResponse Ùˆ openpyxl Ø±Ø§ Ø§ÛŒÙ…Ù¾ÙˆØ±Øª Ú©Ù†ÛŒÙ….

`app directory(orders)/admin.py`

```python
from django.http import HttpResponse
import openpyxl


# ------------------------------- My Actions -------------------------------
def export_to_excel(modeladmin, request, queryset):
    response = HttpResponse(content_type='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')
    response['Content-Disposition'] = 'attachment; filename="orders.xlsx"'

    # ---------------------------
    wb = openpyxl.Workbook()
    ws = wb.active
    ws.title = 'Orders'
    # ---------------------------
    columns = ['ID', 'First Name', 'Last Name', 'Phone', 'Address', 'Postal Code', 'City', 'Province', 'Paid', 'Created']

    ws.append(columns)
    # ---------------------------
    for order in queryset:
        created = order.created.replace(tzinfo=None) if order.created else ''

        row = [order.id, order.firstname, order.lastname, order.phone, order.address, order.postal_code, order.city,
               order.province, order.paid, created]

        ws.append(row)
    # --------------------------
    wb.save(response)
    return response


export_to_excel.short_description = 'export to excel'
```

**ØªÙˆØ¶ÛŒØ­Ø§Øª:**

> Ø§ÛŒÙ† Ø§Ú©Ø´Ù† Ø¨Ù‡ Ù…Ø¯ÛŒØ± Ø³Ø§ÛŒØª Ø§Ù…Ú©Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ ØªØ§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÛŒÚ© queryset (Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ú©Ù‡ Ø§Ø² ÛŒÚ© Ù…Ø¯Ù„ Ø®Ø§Øµ Ø¯Ø± Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ø¬Ù†Ú¯Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯) Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª ÛŒÚ© ÙØ§ÛŒÙ„ Excel (Ø¨Ø§ Ù¾Ø³ÙˆÙ†Ø¯ .xlsx) Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†Ø¯.

1- **Ù†ÙˆØ´ØªÙ† Ø§Ú©Ø´Ù†:** Ø¨Ø±Ø§ÛŒ Ù†ÙˆØ´ØªÙ† Ø§Ú©Ø´Ù†ØŒ ÛŒÚ© ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ù‡ modeladmin, request, queryset Ø±Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† **Ù¾Ø§Ø±Ø§Ù…ØªØ±** Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒÚ©Ù†Ø¯.

- **modeladmin:** Ø§Ø±Ø¬Ø§Ø¹ Ù…ÛŒØ¯Ù‡Ø¯ Ø¨Ù‡ Ú©Ù„Ø§Ø³ modeladmin.(ÛŒÚ© Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø² Ù…Ø¯Ù„ Ø§Ø¯Ù…ÛŒÙ† Ú©Ù‡ ØªØ§Ø¨Ø¹ Ø§Ú©Ø´Ù† Ø§Ø² Ø¢Ù† ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.)

- **request:** Ø¯Ø±Ø®ÙˆØ§Ø³Øª HTTP Ú©Ù‡ Ø§Ø² Ø³Ù…Øª Ú©Ù„Ø§ÛŒÙ†Øª (Ú©Ø§Ø±Ø¨Ø±) Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ Ø§Ø³Øª Ùˆ Ø¨Ø§Ø¹Ø« Ù…ÛŒØ´ÙˆØ¯ Ú©Ù‡ Ø§Ú©Ø´Ù† ÙØ¹Ø§Ù„ Ø´ÙˆØ¯.

- **queryset:** Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² Ø§Ø´ÛŒØ§Ø¡ Ú©Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª.(Ø¯Ø± Ø§ÛŒÙ† Ø§Ú©Ø´Ù†Ø› Ø³ÙØ§Ø±Ø´ Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ø§Ø¯Ù…ÛŒÙ† Ø¯Ø± **Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ†** Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª ØªØ§ Ø¨Ù‡ ØµÙˆØ±Øª Ø§Ú©Ø³Ù„ Ø®Ø±ÙˆØ¬ÛŒ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆÙ†Ø¯.)

2- **Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø§Ø³Ø® Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯**:

```python
response = HttpResponse(content_type='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')

response['Content-Disposition'] = 'attachment; filename="orders.xlsx"'
```

- **Ú©Ù„Ø§Ø³ `HttpResponse`:** Ú©Ù„Ø§Ø³ Ù¾Ø§Ø³Ø®â€ŒØ¯Ù‡ÛŒ Ø¯Ø± Ø¬Ù†Ú¯Ùˆ Ø§Ø³Øª Ú©Ù‡ Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„ Excel Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª.

    > **HttpResponse:** Ø´ÛŒØ¦ÛŒ Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Ù…Ø±ÙˆØ±Ú¯Ø± (Ú©Ù„Ø§ÛŒÙ†Øª) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

- **Ø¢Ø±Ú¯ÙˆÙ…Ø§Ù† `content_type`:** Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§ÛŒ ÙØ§ÛŒÙ„ Ø±Ø§ Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ÛŒÚ© ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡ Ø§Ø³Øª.

    > <span class="rtl-text">Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§ÛŒ Ùˆ Ø¯Ø§Ø¯Ù‡ Ø±Ø§ Ù…Ø´Ø®Øµ Ù…ÛŒÚ©Ù†Ø¯. / Ø¨Ù‡ ØµÙˆØ±Øª Ø²ÛŒØ± Ù†Ø´Ø§Ù† Ø¯Ø§Ø¯Ù‡ Ù…ÛŒØ´ÙˆØ¯. Ø¨Ø§ Ù…Ø«Ø§Ù„</span>
    >
    > <span class="en-text">type/subtype(format) => image/jpg</span>

Ø¨Ø±Ø§ÛŒ Ù…ØªØºÛŒØ± **response** Ø¨Ø§ÛŒØ¯ Ù…Ù‚Ø¯Ø§Ø± Ù‡Ø¯Ø± **Content-Disposition** Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒÙ….

- **`Content-Disposition`:** Ø¨Ù‡ Ù…Ø±ÙˆØ±Ú¯Ø± Ù…ÛŒâ€ŒÚ¯ÙˆÛŒØ¯ Ú©Ù‡ Ù¾Ø§Ø³Ø® Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ ØµÙˆØ±Øª ÛŒÚ© ÙØ§ÛŒÙ„ Ø¶Ù…ÛŒÙ…Ù‡ Ø¨Ø§ Ù†Ø§Ù… "orders.xlsx" Ø¨Ø§Ø´Ø¯ (Ù†Ù‡ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ù…Ø­ØªÙˆØ§ÛŒ ÛŒÚ© ØµÙØ­Ù‡ ÙˆØ¨).

    > **Content-Disposition:** Ù‡Ø¯Ø± HTTP Ú©Ù‡ Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú†Ú¯ÙˆÙ†Ù‡ Ù…Ø­ØªÙˆØ§ÛŒ Ù¾Ø§Ø³Ø® Ø¨Ø§ÛŒØ¯ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø´ÙˆØ¯ØŒ Ù…Ø«Ù„Ø§Ù‹ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ÛŒÚ© ÙØ§ÛŒÙ„ Ù‚Ø§Ø¨Ù„ Ø¯Ø§Ù†Ù„ÙˆØ¯.
    >
    > **attachment:** Ù…Ø´Ø®Øµ Ù…ÛŒÚ©Ù†Ø¯ Ú©Ù‡ Ú©Ù‡ Ù¾Ø§Ø³Ø® Ù…Ø§ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ÛŒÚ© ÙØ§ÛŒÙ„ Ø¶Ù…ÛŒÙ…Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¨Ø§Ø´Ø¯.
    >
    > **filename:** Ø§Ø³Ù… ÙØ§ÛŒÙ„ Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ù¾Ø³ÙˆÙ†Ø¯ Ø¢Ù† Ù…ÛŒØ¨Ø§Ø´Ø¯.

***Ø®Ø¨ Ø­Ø§Ù„Ø§ Ø¨Ø±ÛŒÙ… Ø³Ø±Ø§Øº Ø³Ø§Ø®Øª ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„:***

3- **Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„ Excel Ø¨Ø§ OpenPyXL**:

```python
wb = openpyxl.Workbook()
ws = wb.active
ws.title = 'Orders'
```

- `openpyxl.Workbook()`: Workbook Ø¯Ø±ÙˆØ§Ù‚Ø¹ ÛŒÚ© ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ù…ÛŒØ¨Ø§Ø´Ø¯ Ú©Ù‡ Ù…ÛŒØªÙˆØ§Ù†ÛŒÙ… Ú†Ù†Ø¯ sheet Ø¨Ø±Ø§ÛŒØ´ Ù…Ø´Ø®Øµ Ú©Ù†ÛŒÙ…. / Ù¾Ø³ Ø¨Ø§ Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± ÛŒÚ© ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒÚ©Ù†ÛŒÙ….

- `wb.active`: Ø¨Ø±Ú¯Ù‡ (Sheet) ÙØ¹Ø§Ù„ Ø¯Ø± ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø±Ø§ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯.

- `ws.title = 'Orders'`: Ø¹Ù†ÙˆØ§Ù† Ø¨Ø±Ú¯Ù‡ Ø§Ú©Ø³Ù„ Ø±Ø§ Ø¨Ù‡ "Orders" ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

    > Ø§ØªØ±ÛŒØ¨ÛŒÙˆØª title Ø¹Ù†ÙˆØ§Ù† sheet ÙØ¹Ø§Ù„ Ø±Ø§ ØªØºÛŒÛŒØ± Ù…ÛŒØ¯Ù‡Ø¯.

4- **Ø§ÛŒØ¬Ø§Ø¯ Ùˆ Ø§ÙØ²ÙˆØ¯Ù† Ø¹Ù†ÙˆØ§Ù† Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:

```python
columns = ['ID', 'First Name', 'Last Name', 'Phone', 'Address', 'Postal Code', 'City', 'Province', 'Paid', 'Created']
ws.append(columns)
```

- Ø§Ø³Ù… Ø³ØªÙˆÙ† Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ù‚Ø±Ø§Ø±Ù‡ Ø¯Ø± Ø§Ú©Ø³Ù„ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆÙ†Ø¯ Ø±Ø§ Ø¯Ø± ÛŒÚ© Ù„ÛŒØ³Øª Ù…Ø´Ø®Øµ Ù…ÛŒÚ©Ù†ÛŒÙ….

- Ø¨Ø§ Ù…ØªØ¯ append Ø§ÛŒÙ† Ù„ÛŒØ³Øª Ø±Ø§ Ø¨Ù‡ sheet ÙØ¹Ø§Ù„ Ø¯Ø± ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒÚ©Ù†ÛŒÙ….

5- **Ø§ÙØ²ÙˆØ¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´Ø§Øª Ø¨Ù‡ Ø§Ú©Ø³Ù„**:

```python
for order in queryset:
    created = order.created.replace(tzinfo=None) if order.created else ''

    row = [order.id, order.firstname, order.lastname, order.phone, order.address, order.postal_code, order.city, order.province, order.paid, created]

    ws.append(row)
```

- **Ù†Ú©ØªÙ‡:** Ù†Ù…ÛŒØ´Ù‡ Ù…Ù†Ø·Ù‚Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø±Ø§ Ø¯Ø± Ø§Ú©Ø³Ù„ Ø°Ø®ÛŒØ±Ù‡ Ú©Ø±Ø¯(Ø§Ø±ÙˆØ± Ù…ÛŒØ¯Ù‡Ø¯)Ø› Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ† Ø¨Ø§ÛŒØ¯ Ù…Ù†Ø·Ù‚Ù‡ Ø²Ù…Ø§Ù†ÛŒ(time zone)ØŒ Ø±Ø§ Ø§Ø² ØªØ§Ø±ÛŒØ® Ø­Ø°Ù Ú©Ù†ÛŒÙ….

    > Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú©Ø§Ø±ØŒ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø³ÙØ§Ø±Ø´ ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯ Ø±Ø§ ØµØ¯Ø§ Ø²Ø¯Ù‡ Ùˆ tzinfo (Ù…Ø®ÙÙ timezone info) Ø±Ø§ None Ù…ÛŒÚ©Ù†ÛŒÙ…./ Ø¨Ø±Ø§ÛŒ Ø§Ø­ØªÛŒØ§Ø· Ø´Ø±Ø· Ù…ÛŒÚ¯Ø°Ø§Ø±ÛŒÙ… Ú©Ù‡ Ø§Ú¯Ø± ØªØ§Ø±ÛŒØ® ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªØ› Ù…Ù†Ø·Ù‚Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø±Ø§ Ù¾Ø§Ú© Ú©Ù† ØªØ§ Ø§Ø±ÙˆØ± Ù†Ø¯Ù‡Ø¯.

- Ø¯Ø± Ø­Ù„Ù‚Ù‡ for Ø¨Ø§ÛŒØ¯ Ù‡Ø± Ø¨Ø§Ø±ØŒ Ø¨Ø±Ø§ÛŒ Ø³ØªÙˆÙ† Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯ÛŒÙ… Ø¨Ù‡ Ù‡Ù…Ø§Ù† ØªØ±ØªÛŒØ¨ØŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø±Ø§ Ø§Ø² Ø³ÙØ§Ø±Ø´ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ùˆ Ø¢Ù†Ù‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ÛŒÚ© Ø±Ø¯ÛŒÙ Ø¨Ù‡ Ø§Ú©Ø³Ù„ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒÙ….

    > Ø¨Ø±Ø§ÛŒ ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯ Ø§Ø² Ù…ØªØºÛŒØ±ÛŒ Ú©Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯ÛŒÙ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ…. / ØªØ§ Ù…Ù†Ø·Ù‚Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ù†Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯.


6- **Ø°Ø®ÛŒØ±Ù‡ Ú©Ø±Ø¯Ù† ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø¯Ø± Ù¾Ø§Ø³Ø®**:

```python
wb.save(response)
return response
```

- `wb.save(response)`: ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø¯Ø± Ø´ÛŒØ¡ Ù¾Ø§Ø³Ø® HTTP Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

    > Ø¨Ø¹Ø¯ Ø§Ø² Ø­Ù„Ù‚Ù‡ for  Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…ØªØ¯ saveØŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ…Ø› Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø¯Ø± Ù…ØªØºÛŒØ± response Ø°Ø®ÛŒØ±Ù‡ Ø´ÙˆØ¯ØŒ Ø¯Ø§Ø®Ù„ Ù¾Ø±Ø§Ù†ØªØ²Ù‡Ø§ÛŒ Ù…ØªØ¯ save Ø¹Ø¨Ø§Ø±Øª response Ø±Ø§ Ù…ÛŒÙ†ÙˆÛŒØ³ÛŒÙ….

- `return response`: Ù¾Ø§Ø³Ø® Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ú©Ù‡ Ø¨Ø§Ø¹Ø« Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯.

7- Ø¯Ø± Ù†Ù‡Ø§ÛŒØª Ù…ÛŒØªÙˆØ§Ù†ÛŒÙ… Ø¨Ø±Ø§ÛŒ Ø§Ú©Ø´Ù† ÛŒÚ© Ø§Ø³Ù… Ø¯Ù„Ø®ÙˆØ§Ù‡  Ù…Ø³ØªØ¹Ø§Ø± Ù…Ø´Ø®Øµ Ù†ÛŒÙ… ØªØ§ Ø¯Ø± Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯.

**Ù…Ø¹Ø±ÙÛŒ Ø§Ú©Ø´Ù† Ø¨Ù‡ Ù…Ø¯Ù„ Ø§Ø¯Ù…ÛŒÙ† Order:**

`app directory(orders)/admin.py`

```python
@admin.register(Order)
class OrderAdmin(admin.ModelAdmin):
    list_display = ('id', 'buyer', 'firstname', 'lastname', 'phone', 'province', 'city', 'paid')
    list_filter = ('paid', 'created', 'update')
    list_display_links = ['firstname']
    inlines = [OrdersItemInline]
    # Ù…Ø¹Ø±ÙÛŒ Ø§Ú©Ø´Ù† Ø¨Ù‡ Ù…Ø¯Ù„ Ø§Ø¯Ù…ÛŒÙ†:
    actions = [export_to_excel]
```

<hr>

#### Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ:

Ù…ÛŒØ®ÙˆØ§Ù‡ÛŒÙ… Ø¯Ø± Ù…ÙˆØ±Ø¯ `HttpResponse`, `content_type`, Ùˆ `MIME-type` ÛŒÚ©Ø³Ø±ÛŒ ØªÙˆØ¶ÛŒØ­Ø§Øª Ø§Ø¶Ø§ÙÙ‡ ØªØ± Ø¨ÛŒØ§Ù† Ú©Ù†ÛŒÙ….(Ø¬Ù‡Øª Ø¯Ø±Ú© Ø¨ÛŒØ´ØªØ±)

**1- HttpResponse**

**ØªÙˆØ¶ÛŒØ­:**
`HttpResponse` ÛŒÚ© Ú©Ù„Ø§Ø³ Ø¯Ø± ÙØ±ÛŒÙ…ÙˆØ±Ú© Ø¬Ù†Ú¯Ùˆ Ø§Ø³Øª Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù¾Ø§Ø³Ø® HTTP Ø§Ø² Ø³Ù…Øª Ø³Ø±ÙˆØ± Ø¨Ù‡ Ú©Ù„Ø§ÛŒÙ†Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§ÛŒÙ† Ú©Ù„Ø§Ø³ Ø¨Ù‡ Ø´Ù…Ø§ Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ ØªØ§ Ù…Ø­ØªÙˆØ§ÛŒ Ù¾Ø§Ø³Ø®ØŒ Ù‡Ø¯Ø±Ù‡Ø§ØŒ Ùˆ Ú©Ø¯ ÙˆØ¶Ø¹ÛŒØª HTTP Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯.

> Ø¨Ù‡ Ø¹Ø¨Ø§Ø±ØªÛŒØŒ Ù‡Ø± Ø²Ù…Ø§Ù† Ú©Ù‡ ÛŒÚ© Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ø³Ø±ÙˆØ± Ø¨Ø§ÛŒØ¯ Ù¾Ø§Ø³Ø®ÛŒ Ø±Ø§ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯. Ø§ÛŒÙ† Ù¾Ø§Ø³Ø® Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ÛŒÚ© ØµÙØ­Ù‡ HTMLØŒ ÛŒÚ© ÙØ§ÛŒÙ„ØŒ ÛŒØ§ Ù‡Ø± Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡ Ø¯ÛŒÚ¯Ø±ÛŒ Ø¨Ø§Ø´Ø¯.


**2- content_type**

**ØªÙˆØ¶ÛŒØ­:**
`content_type` ÛŒÚ© ÙˆÛŒÚ˜Ú¯ÛŒ Ø§Ø² Ø´ÛŒØ¡ `HttpResponse` Ø§Ø³Øª Ú©Ù‡ Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ú©Ù‡ Ø¯Ø± Ù¾Ø§Ø³Ø® Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ø±Ø§ Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ø§ÛŒÙ† Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² MIME-type Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ø¨Ù‡ Ù…Ø±ÙˆØ±Ú¯Ø± Ù…ÛŒâ€ŒÚ¯ÙˆÛŒØ¯ Ú©Ù‡ Ú†Ú¯ÙˆÙ†Ù‡ Ø¨Ø§ÛŒØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØªâ€ŒØ´Ø¯Ù‡ Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú©Ù†Ø¯.

**3- MIME-type**

**ØªÙˆØ¶ÛŒØ­:**
MIME-type (Multipurpose Internet Mail Extensions) Ù†ÙˆØ¹ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø®Øµ Ú©Ø±Ø¯Ù† Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ø§ÛŒÙ†ØªØ±Ù†Øª Ø§Ø³Øª. Ø§ÛŒÙ† Ù†ÙˆØ¹ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ù‡ Ù…Ø±ÙˆØ±Ú¯Ø± ÛŒØ§ Ø³Ø§ÛŒØ± Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§ Ú©Ù…Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯ ØªØ§ Ø¨Ø¯Ø§Ù†Ù†Ø¯ Ú†Ú¯ÙˆÙ†Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú©Ù†Ù†Ø¯ Ùˆ Ø¢Ù†Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‡Ù†Ø¯.

**ÙØ±Ù…Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ MIME Ø¨Ù‡ Ø´Ú©Ù„ `type/subtype` Ø§Ø³Øª Ùˆ Ù‡Ø± Ø¨Ø®Ø´ Ø¢Ù† ØªÙˆØ¶ÛŒØ­â€ŒØ¯Ù‡Ù†Ø¯Ù‡â€ŒÛŒ Ù†ÙˆØ¹ Ùˆ Ø²ÛŒØ±Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Ø³Øª.**


- **type** (Ù†ÙˆØ¹): Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ú©Ù„ÛŒ Ù…Ø­ØªÙˆØ§ Ø±Ø§ Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ù…Ø§Ù†Ù†Ø¯ `text`ØŒ `image`ØŒ `application`ØŒ `audio`ØŒ `video` Ùˆ ØºÛŒØ±Ù‡.
- **subtype** (Ø²ÛŒØ±Ù†ÙˆØ¹): Ù†ÙˆØ¹ Ø®Ø§Øµâ€ŒØªØ±ÛŒ Ø§Ø² Ù…Ø­ØªÙˆØ§ Ø±Ø§ Ø¯Ø± Ø¢Ù† Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ø¨Ø±Ø§ÛŒ Ù…Ø«Ø§Ù„ØŒ Ø¯Ø± Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ `text`ØŒ Ø²ÛŒØ±Ù†ÙˆØ¹ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ `html`ØŒ `plain` Ùˆ ... Ø¨Ø§Ø´Ø¯.


**`text/plain`**:
- **type**: `text`
- **subtype**: `plain`
- **Ú©Ø§Ø±Ø¨Ø±Ø¯**: Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù…ØªÙ† Ø³Ø§Ø¯Ù‡ Ø¨Ø¯ÙˆÙ† Ù‚Ø§Ù„Ø¨â€ŒØ¨Ù†Ø¯ÛŒ.

**Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§:**
- `text/plain` Ø¨Ø±Ø§ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÛŒ Ø³Ø§Ø¯Ù‡
- `image/jpeg` Ø¨Ø±Ø§ÛŒ ØªØµØ§ÙˆÛŒØ± JPEG
- `application/json` Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ JSON
- `application/vnd.openxmlformats-officedocument.spreadsheetml.sheet` Ø¨Ø±Ø§ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ú©Ø³Ù„ (xlsx)

***Ø¬Ù…Ø¹â€ŒØ¨Ù†Ø¯ÛŒ:***

- **HttpResponse**: Ú©Ù„Ø§Ø³ Ù¾Ø§Ø³Ø®â€ŒØ¯Ù‡ÛŒ Ø¯Ø± Ø¬Ù†Ú¯Ùˆ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±.

- **content_type**: Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§ÛŒ Ø§Ø±Ø³Ø§Ù„ÛŒ Ø¯Ø± Ù¾Ø§Ø³Ø® Ú©Ù‡ Ù†Ø­ÙˆÙ‡â€ŒÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¢Ù† Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø± Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

- **MIME-type**: Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ¹ÛŒÛŒÙ† Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ú©Ù‡ Ø¨Ù‡ Ù…Ø±ÙˆØ±Ú¯Ø± Ú©Ù…Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯ ØªØ§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ù†Ù…Ø§ÛŒØ´ ÛŒØ§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú©Ù†Ø¯. 

### ØªÙ…Ø±ÛŒÙ†Ø§Øª ÙØµÙ„ 11 (Ù…Ù‡Ù…)

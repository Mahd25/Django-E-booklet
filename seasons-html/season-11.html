<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<title>Season Eleven</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Django e-booklet">
<meta name="keywords" content="django, django learning">
<meta name="author" content="Mahdi Rezaie, Ali Ebrahimian">
<link rel="icon" href="../Images/favicon.ico" type="image/ico">

<link rel="stylesheet" type="text/css" href="https://mahd25.github.io/assets/CSS/seasons-style.css">
<link rel="stylesheet" type="text/css" href="https://mahd25.github.io/assets/CSS/Footer-style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
<main>
    <div class="container">
        <div class="content">
            <h2>ูุตู ุงุฒุฏูู: ุงูพูฺฉุดู ูุฑูุดฺฏุงู ุงูุชุฑูุช (ุจุฎุด ุฏูู)</h2><div class="toc"><h3>ููุฑุณุช ูุทุงูุจ</h3><ul>
<li><a href="#snrywy-tkhmyl-frynd-khryd">ุณูุงุฑู ุชฺฉูู ูุฑุงูุฏ ุฎุฑุฏ</a></li>
<li><a href="#rsl-pymkh-b-wb-srwys-khwh-ngr">ุงุฑุณุงู ูพุงูฺฉ ุจุง ูุจ ุณุฑูุณ (ฺฉุงูู ูฺฏุงุฑ)</a></li>
<li><a href="#pydh-szy-dryft-shmrh-khrbr">ูพุงุฏู ุณุงุฒ ุฏุฑุงูุช ุดูุงุฑู ฺฉุงุฑุจุฑ</a></li>
<li><a href="#rsl-w-brrsy-khd-tyyd-bh-shmrh-khrbr">ุงุฑุณุงู ู ุจุฑุฑุณ ฺฉุฏ ุชุงุฏ ุจู ุดูุงุฑู ฺฉุงุฑุจุฑ</a></li>
<li><a href="#dryft-mshkhst-sfrsh-z-khrbr">ุฏุฑุงูุช ูุดุฎุตุงุช ุณูุงุฑุด ุงุฒ ฺฉุงุฑุจุฑ</a></li>
<li><a href="#tsl-drgh-prdkht-zryn-pl-bh-frwshgh">ุงุชุตุงู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช (ุฒุฑู ูพุงู) ุจู ูุฑูุดฺฏุงู</a></li>
<li><a href="#sfht-wd-yt-prdkht-lyst-w-jzyyt-sfrsh">ุตูุญุงุช ูุถุนุช ูพุฑุฏุงุฎุชุ ูุณุช ู ุฌุฒุฆุงุช ุณูุงุฑุด</a></li>
<li><a href="#qblyt-khrwjy-fyl-excel-z-sfrsh-h-dr-pnl-dmyn">ูุงุจูุช ุฎุฑูุฌ ูุงู Excel ุงุฒ ุณูุงุฑุด ูุง ุฏุฑ ูพูู ุงุฏูู</a></li>
<li><a href="#tmrynt-fsl-11-mhm">ุชูุฑูุงุช ูุตู 11 (ููู)</a></li>
</ul></div>
<h3 id="snrywy-tkhmyl-frynd-khryd">ุณูุงุฑู ุชฺฉูู ูุฑุงูุฏ ุฎุฑุฏ</h3>
<p><strong>ุงู ุจุฎุด ุงุฒ ุขููุฒุด ุตุฑูุง ุชุฆูุฑ ุจูุฏู ู ุฎุจุฑ ุงุฒ ฺฉุฏ ุฒุฏู ูุณุช!</strong></p>
<p><strong>ูุฑุงูุฏ ุชฺฉูู ุฎุฑุฏ =&gt;</strong> ฺฉุงุฑุจุฑ ุณุจุฏ ุฎุฑุฏ ุฑุง ฺฉุงูู ฺฉุฑุฏู ู ุฑู ุงุฏุงูู ุฎุฑุฏ ฺฉูฺฉ ฺฉุฑุฏูุ ุงุฒ ุงูุฌุง ุณูุงุฑู ูุฑุงูุฏ ุฎุฑุฏ ุดุฑูุน ูุดูุฏ:</p>
<p><strong>ุญุงูุง ุฏู ุญุงูุช ูุฌูุฏ ุฏุงุฑุฏ:</strong></p>
<p><strong>1-</strong> ฺฉุงุฑุจุฑ ุงุฒ ูุจู ูุงฺฏู ฺฉุฑุฏู ุงุณุช.  <br />
<strong>2-</strong> ฺฉุงุฑุจุฑ ูููุฒ ูุงฺฏู ูฺฉุฑุฏู ุงุณุช.</p>
<ol>
<li>
<p><strong>ุงฺฏุฑ ฺฉุงุฑุจุฑ ุงุฒ ูุจู ูุงฺฏู  ฺฉุฑุฏู ุจูุฏ:</strong> ููุช ุงุฏุงูู ุฎุฑุฏ ุฑุง ุงูุชุฎุงุจ ูฺฉูุฏ ฺูุงูฺู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ฺฉุงูู ุจุงุดุฏุ ุจู ุตูุญู ุชุงุฏ ุฎุฑุฏ ู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ููุชูู ูุดูุฏ. </p>
<p>ุงฺฏุฑ ูู ุงุทูุงุนุงุช ฺฉุงูู ูุณุชุ ุงุจุชุฏุง ุจู ุตูุญู ุชฺฉูู ูุฑู ุงุทูุงุนุงุช ู ุณูพุณ ุจู ุตูุญู ุชุงุฏ ุฎุฑุฏ ู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ููุชูู ูุดูุฏ.</p>
</li>
<li>
<p><strong>ฺฉุงุฑุจุฑ ูุงฺฏู ูฺฉุฑุฏู ุงุณุช:</strong> ูพุณ ุงุฒ ุงูุชุฎุงุจ ูุญุตููุงุช ููุช ุฑู  ุงุฏุงูู ุฎุฑุฏ ฺฉูฺฉ ูฺฉูุฏ ุงุฒ ฺฉุงุฑุจุฑ ฺฉ ุดูุงุฑู ุชููู ุจุฑุง ุชุงุฏ ุดุฎุต ุฏุฑุฎูุงุณุช ูฺฉูุฏ(ฺฉ ฺฉุฏ ุจุฑุง ุดูุงุฑู ุชููู ุงุฑุณุงู ูุดูุฏ.)ุ </p>
<p><strong>ุงฺฏุฑ ุดูุงุฑู ุงุฒ ูุจู ุฏุฑ ุฏุชุงุจุณ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ(ุญุณุงุจ ุฏุงุดุชู ุจุงุดุฏ)</strong>ุ ฺฉุงุฑุจุฑ ุฑุง ุจู ุตูุญู ุชุงุฏ ุฎุฑุฏ ู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ููุชูู ูฺฉูู.</p>
<p><strong>ุงฺฏุฑ ุดูุงุฑู ูุฌูุฏ ูุฏุงุดุช</strong>ุ ุจุฑุง ุขู ุดุฎุต ุจุง ุชูุฌู ุจู ุดูุงุฑู ุชููู ฺฉ ุญุณุงุจ ฺฉุงุฑุจุฑ ุงุฌุงุฏ ูฺฉูู ู ุณูพุณ ฺฉุงุฑุจุฑ ุฑุง ุจู ุตูุญู ุชุงุฏ ุฎุฑุฏ ููุชูู ูฺฉูู.</p>
<ul>
<li>ุฏุฑ ฺฉ ูุฑู  ูุดุฎุตุงุช ฺฏุฑูุฏู ุณูุงุฑุด ุฑุง ุงุฒ ฺฉุงุฑุจุฑ ุฏุฑุงูุช ูฺฉูู.</li>
</ul>
</li>
</ol>
<h3 id="rsl-pymkh-b-wb-srwys-khwh-ngr">ุงุฑุณุงู ูพุงูฺฉ ุจุง ูุจ ุณุฑูุณ (ฺฉุงูู ูฺฏุงุฑ)</h3>
<p><strong>ูฺฉุชู:</strong> ุจุฑุง ุงุฑุณุงู ูพุงูฺฉ ุฏุฑ <strong>ูุจ ุณุฑูุณ ูุง ูพุงูฺฉ</strong> ูุงุฒู ุงุณุช ฺฉู ุฏุฑ ุขู ูุจุณุงุช ูุง ุซุจุช ูุงู ฺฉุฑุฏู ู ูุฑุงุญู ุงุญุฑุงุฒ ููุช ุฑุง ุชฺฉูู ฺฉูุฏ.</p>
<p>ุจุฑุง ุงุฑุณุงู ฺฉุฏ ุชุงุฏุ ุงุทูุงุน ุฑุณุงู ูุงุ ูุถุนุช ุณูุงุฑุด ุฎุฑุฏุงุฑ ู... ุงุฒ ุณุฑูุณ ูพุงูฺฉ ุงุณุชูุงุฏู ูฺฉูู.</p>
<p>ุฏุฑ ุงูุฌุง ูุจ ุณุฑูุณ ูพุงูฺฉ ฺฉุงูู ูฺฏุงุฑ ุฑุง ูุนุฑู ูฺฉูู ูู ุดูุง ูุชูุงูุฏ ุงุฒ ูุจ ุณุฑูุณ ูุง ุฏฺฏุฑ ุงุณุชูุงุฏู ฺฉูุฏุ ฺูู ุณุงุฎุชุงุฑ ู ูุญูู ุงุณุชูุงุฏู ุชูุฑุจุง ูุดุงุจู ฺฉุฏฺฏุฑ ูุจุงุดุฏ.</p>
<p><strong>1-</strong> ุฏุฑ ูุฑุญูู ุงูู ูุงุฒู ุงุณุช ุซุจุช ูุงู ู ุงุญุฑุงุฒ ููุช ุฑุงุ ฺฉู ุฏุฑ ูุจุณุงุช ุณุฑูุณ ูพุงูฺฉ ุงูุฌุงู ุฏูู.</p>
<p><strong>2-</strong> ุฏุฑ ุจุฎุด <strong><em>ุญุณุงุจ ูู</em></strong> ฺฉ API Key ูุฌูุฏ ุฏุงุฑุฏุ ฺฉู ุฏุฑ ฺฉุฏูุง ุจู ุขู ูุงุฒ ุฏุงุฑู. / ุจุง ฺฉูฺฉ ุฑู ุขฺฉูู ฺฉูุฏ (๐)  ฺฉ API ุฌุฏุฏ ุงุฌุงุฏ ูฺฉูุฏ(API ูุจู ูููุถ ูุดูุฏ.)</p>
<p><strong>ูพุงูฺฉ ูุง ุงุฑุณุงู ุฏู ุญุงูุช ุฏุงุฑูุฏ:</strong></p>
<p>1- ูพุงูฺฉ ูุง ฺฉุฏ ุชุงุฏ ุง ุฏุงุฑุง ฺฉ ฺฉููู ุฎุงุต(ูพุงูฺฉ ูุง ุชูฺฉู ุฏุงุฑ)  <br />
2- ูพุงูฺฉ ุนุงุฏ (ุดุงูู ฺฉ ูุชู ุณุงุฏู)</p>
<p><strong>ูฺฉุชู:</strong> ูุฏุฑุช ู ุณุงุฎุชุงุฑ ูพุงูฺฉ ูุง ุชูฺฉู ุฏุงุฑ ุฏุฑ ุจุฎุด ุงุนุชุจุงุฑุณูุฌ ุณุฑูุณ ูพุงูฺฉ (ฺฉุงูู ูฺฏุงุฑ) ุงูุฌุงู ูุดูุฏ.</p>
<p><a href="https://res.cloudinary.com/am-er/image/upload/v1724505875/kavenegar-client-Verification_ewem5f.png"><img alt="verification-SMS" src="https://res.cloudinary.com/am-er/image/upload/v1724505875/kavenegar-client-Verification_ewem5f.png" / class="edu-img"></a></p>
<p><strong>ุชูุถุญุงุช:</strong></p>
<p>1- ุงุฒ ุจุฎุด <strong>ุชุนุฑู ุงูฺฏู ุงุนุชุจุงุฑ ุณูุฌ</strong>ุ ูุชูุงูู ฺฉ ูพุงูฺฉ ุชูฺฉู ุฏุงุฑ ุฌุฏุฏ ุงุฌุงุฏ ฺฉูู.</p>
<p>2- <strong>ูุงู ุงูฺฏู</strong>ุ ุงุณู ุชููพูุช ูุณุช ฺฉู ุฏุฑ ุณุงุฎุชุงุฑ ฺฉุฏ ุงุฒ ุขู ุงุณุชูุงุฏู ูฺฉูู.</p>
<p>3- ูุชู ฺฉู ูุฑุงุฑ ุงุณุช ุจู ฺฉุงุฑุจุฑุงู ุงุฑุณุงู ุดูุฏ ุฏุฑ <strong>ูุชู ุงูฺฏู ูพุงูฺฉ</strong> ููุดุชู ูุดูุฏ.</p>
<blockquote>
<p><span class="rtl-text">ุจุฎุด ูุชุบุฑ ูุญุชูุง ูุชู ูุงุ <span class="en-text">%token</span> ูุจุงุดุฏ ฺฉู ุฏุฑ view ุฌูฺฏู ุขูุฑุง ููุฏุงุฑ ุฏู ูฺฉูู.</span></p>
</blockquote>
<p><strong>ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณ ูพุงูฺฉ ฺฉุงูู ูฺฏุงุฑ ูุงุฒู ุงุณุช ฺฉู ฺฉุงุจุฎุงูู ุขูุฑุง ูุตุจ ฺฉูู.</strong></p>
<p><code>Terminal</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">terminal</span>
        </div>
    <pre><span></span>pip install kavenegar
</pre></div>

<p><strong>ุณุงุฎุชุงุฑ ูพุงูฺฉ ูุง ุชูฺฉู ุฏุงุฑ ู ุนุงุฏ:</strong></p>
<p>ุงูู ุจุฑุง ูพุงูฺฉ ูุง ุชูฺฉู ุฏุงุฑ ู ุฏูู ุจุฑุง ูพุงูฺฉ ูุง ุนุงุฏ ุงุณุชูุงุฏู ูุดูุฏ.</p>
<p><code>app directory(cart)/commom/KaveSms.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="kn">from</span> <span class="nn">kavenegar</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">HTTPError</span>


<span class="k">def</span> <span class="nf">send_sms_with_template</span><span class="p">(</span><span class="n">receptor</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">template</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sending sms that needs template</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">api</span> <span class="o">=</span> <span class="n">KavenegarAPI</span><span class="p">(</span><span class="s1">&#39;ุฏุฑ ุจุฎุด ุญุณุงุจ ูู API Key&#39;</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;receptor&#39;</span><span class="p">:</span> <span class="n">receptor</span><span class="p">,</span>
            <span class="s1">&#39;template&#39;</span><span class="p">:</span> <span class="n">template</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tokens</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">verify_lookup</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="n">APIException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="c1"># ---------------------------------------</span>
<span class="k">def</span> <span class="nf">send_sms_normal</span><span class="p">(</span><span class="n">receptor</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">api</span> <span class="o">=</span> <span class="n">KavenegarAPI</span><span class="p">(</span><span class="s1">&#39;ุฏุฑ ุจุฎุด ุญุณุงุจ ูู API Key&#39;</span><span class="p">)</span>

        <span class="n">params_buyer</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;receptor&#39;</span><span class="p">:</span> <span class="n">receptor</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
            <span class="s1">&#39;sender&#39;</span><span class="p">:</span> <span class="s1">&#39;10005000505077&#39;</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">sms_send</span><span class="p">(</span><span class="n">params_buyer</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">APIException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<p>ุจุฑุง ุฑุงุญุช ฺฉุฏูุง ุงุฑุณุงู ูพุงู ุฑ ุจู ุตูุฑุช ุชุงุจุน ููุดุชู ู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุขููุง ุฏุฑ view ุชุงุจุน ูุฏูุธุฑ ุฑุง ุตุฏุง ูุฒููุ ุชุง ุงุฒ ุชฺฉุฑุงุฑ ฺฉุฏ ุฌููฺฏุฑ ุดูุฏ.</p>
<p>1- ุฏุฑ ุชุงุจุน <strong>send_sms_with_template</strong>:</p>
<ul>
<li>
<p><strong>receptor</strong> =&gt; ุดูุงุฑู ฺฏุฑูุฏู ูพุงู ูุจุงุดุฏ(ูุดุชุฑุงู ู ุฎุฑุฏุงุฑุงู ูุฑูุดฺฏุงู)</p>
</li>
<li>
<p><strong>tokens</strong> =&gt; ฺฉ ุฏฺฉุดูุฑุ ุดุงูู ูุชุบุฑูุง ูุญุชูุง ูุชู ูุจุงุดุฏ (ูุซุงู: {'token': 254168})</p>
</li>
<li>
<p><strong>template</strong> =&gt; ููุงู  <strong>ูุงู ุงูฺฏู</strong> ูุจุงุดุฏุ ฺฉู ุฏุฑ ุจุฎุด <strong>ุชุนุฑู ุงูฺฏู ุงุนุชุจุงุฑ ุณูุฌ</strong> ุขูุฑุง ุชุนุฑู ฺฉุฑุฏู ุงู.</p>
</li>
</ul>
<blockquote>
<p><span class="rtl-text">ุฏุฑ ุงู ุญุงูุช ุฏฺฏุฑ ูุงุฒู ูุณุช ูุชู ุจููุณู ู ููุท ููุฏุงุฑ ุชูฺฉู ูุง ุฑุง ุงุฑุณุงู ูฺฉููุ ุชุง ุฏุฑ ูุญุชูุง ูุชู ุงุนุชุจุงุฑุณูุฌ ุจุฌุง (<span class="en-text">%token</span>) ูุฑุงุฑ ฺฏุฑูุชู ู ุจุฑุง ฺฉุงุฑุจุฑ ุงุฑุณุงู ุดูุฏ.</span></p>
</blockquote>
<p>2- ุฏุฑ ุชุงุจุน <strong>send_sms_normal</strong>:</p>
<ul>
<li>
<p><strong>receptor</strong> =&gt; ุดูุงุฑู ฺฏุฑูุฏู ูพุงู ูุจุงุดุฏ(ูุดุชุฑุงู ู ุฎุฑุฏุงุฑุงู ูุฑูุดฺฏุงู)</p>
</li>
<li>
<p><strong>message</strong> =&gt; ูุญุชูุง ูุชู ูพุงู.</p>
</li>
</ul>
<p><strong>ุงู ฺฉุฏ ูุง ุฑุง ุฏุฑ ูุงู KaveSms.py ููุดุชู ู ุขูุฑุง ุฏุฑ ุงูพ cart ูุฑุงุฑ ูุฏูู.</strong></p>
<blockquote>
<p>ุญุงู ูุฑุฌุง ูุงุฒ ุฏุงุดุชู ุจุงุดูุ ฺฉ ุงุฒ ุชูุงุจุน ุขูุฑุง ุงููพูุฑุช ฺฉุฑุฏู ู ุขุฑฺฏููุงู ูุง ุฑุง ุจุฑุงุด ูุดุฎุต ูฺฉูู.</p>
</blockquote>
<h3 id="pydh-szy-dryft-shmrh-khrbr">ูพุงุฏู ุณุงุฒ ุฏุฑุงูุช ุดูุงุฑู ฺฉุงุฑุจุฑ</h3>
<p>ุฏุฑ ุงูพ orders ูุงู urls.py ุฑุง ุงุฌุงุฏ ูฺฉูู.</p>
<p><strong>ุฏุฑ ุขู ุณู url ูุณุงุฒูุ</strong><br />
1- ุจุฑุง ุฏุฑุงูุช ุดูุงุฑู ุชููู <br />
2- ุจุฑุง ุฏุฑุงูุช ฺฉุฏ ุชุงุฏ  <br />
3- ุจุฑุง ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฏุฑูุฏู ุณูุงุฑุด</p>
<p><code>app directory(orders)/urls.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>


<span class="n">app_name</span> <span class="o">=</span> <span class="s1">&#39;orders&#39;</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;verify-phone&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">verify_phone</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;verify_phone&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;verify-code&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">verify_code</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;verify_code&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;order-create&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">order_create</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;order_create&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>

<p><strong>ูุนุฑู ุงู ูุงู ุจู ูพุฑูฺู:</strong></p>
<p><code>project directory/urls.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ...</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;order/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;orders.urls&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;orders&#39;</span><span class="p">)),</span>
<span class="p">]</span>
</pre></div>

<p><strong>ูฺฉุชู:</strong> ุฏุฑ ุงูพ cart ุจุฑุง ุชููพูุช ุณุจุฏ ุฎุฑุฏุ ฺฉ ุฏฺฉูู ุจุฑุง <strong>ุงุฏุงูู ุฎุฑุฏ</strong> ุงุฌุงุฏ ฺฉุฑุฏู ุจูุฏูุ ุญุงูุง ุจุฑุง href ุขู url (ุขุฏุฑุณ) verify-phone ุฑุง ูุดุฎุต ูฺฉูู.</p>
<blockquote>
<p>ุจุฑุง ุฑุงุญุช ฺฉุฏ ูุง ุทููุงู ุฑุง collapse ฺฉุฑุฏู.(ุจุณุชู)</p>
</blockquote>
<p><code>app(cart)/templates/cart/cart_detail.html</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">jinja</span>
        </div>
    <pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;parent/base/base_template.html&#39;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span><span class="x">products</span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
<span class="x">    &lt;div class=&quot;header&quot;&gt;</span>
<span class="x">        &lt;h1&gt;ุณุจุฏ ุฎุฑุฏ&lt;/h1&gt;</span>
<span class="x">    &lt;/div&gt;</span>

<span class="x">    &lt;div class=&quot;cart-content&quot;&gt;</span>
<span class="x">&gt;       </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="k">in</span> <span class="nv">cart</span> <span class="p">...</span> <span class="cp">%}</span>


<span class="x">&gt;       &lt;div class=&quot;cart-total-price&quot;...&gt;</span>


<span class="x">        &lt;div class=&quot;checkout-button&quot;&gt;</span>
<span class="x">            &lt;div class=&quot;continue-btn&quot;&gt;&lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;orders:verify_phone&#39;</span> <span class="cp">%}</span><span class="x">&quot;&gt;ุงุฏุงูู ุฎุฑุฏ&lt;/a&gt;&lt;/div&gt;</span>
<span class="x">            &lt;div class=&quot;back-btn&quot;&gt;&lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s2">&quot;shop:products-list&quot;</span> <span class="cp">%}</span><span class="x">&quot;&gt;ุจุฑฺฏุดุช ุจู ูุณุช ูุญุตููุงุช&lt;/a&gt;&lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>

<span class="x">    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js&quot; integrity=&quot;sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==&quot; crossorigin=&quot;anonymous&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/script&gt;</span>

<span class="x">&gt;    &lt;script...&gt;</span>
<span class="x">       </span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>

<p>ุฏุฑ ุงูพ order ูุงู forms.py ุฑุง ุงุฌุงุฏ ฺฉุฑุฏู ู ุฏุฑ ุขู ฺฉ ูุฑู ุจุฑุง ุฏุฑุงูุช ุดูุงุฑู ุชููู ฺฉุงุฑุจุฑ ู ุงุนุชุจุงุฑุณูุฌ ุขู ุงุฌุงุฏ ูฺฉูู.</p>
<p><code>app directory(orders)/forms.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="k">class</span> <span class="nc">PhoneVerificationForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">phone_number</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clean_phone_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">phone_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;phone_number&#39;</span><span class="p">]</span>

        <span class="c1"># conditions....</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">phone_number</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Phone number must be digit&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">phone_number</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Phone number must be 11 digits&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">phone_number</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;09&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Phone number must start with 09&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">phone_number</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<p>ูพุณ ุงุฒ ุงุฌุงุฏ ููุฏ ุดูุงุฑู ุชูููุ ุจุฑุง ุขู ุงุนุชุจุงุฑุณูุฌ ุงูุฌุงู ูุฏูู.</p>
<p>1- ุดูุงุฑู ุชููู ุจุงุฏ ุจู ุนุฏุฏ ุจุงุดุฏ.</p>
<p>2- ุชุนุฏุงุฏ ุงุฑูุงู ุขู ุจุงุฏ 11 ุชุง ุจุงุดุฏ.</p>
<p>3- ุจุงุฏ ุจุง 09 ุดุฑูุน ุดูุฏ.</p>
<p>ููุงุชุง ุงฺฏุฑ ูุดฺฉู ูุฏุงุดุช ุขูุฑุง return ูฺฉูู.</p>
<p><strong>ุงุฌุงุฏ view ุจุฑุง ุฏุฑุงูุช ู ุจุฑุฑุณ ุดูุงุฑู ุชููู:</strong></p>
<p><code>app directory(orders)/views.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">messages</span>
<span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">cart.common.KaveSms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">random</span>


<span class="c1"># Create your views here.</span>
<span class="k">def</span> <span class="nf">verify_phone</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;orders:order_create&#39;</span><span class="p">)</span>
    <span class="c1"># โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">PhoneVerificationForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
            <span class="n">phone</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;phone_number&#39;</span><span class="p">)</span>

            <span class="c1"># verification code</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s1">&#39;0123456789&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
            <span class="n">tokens</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">code</span><span class="p">}</span>

            <span class="c1"># save in session...</span>
            <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;verification_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span>
            <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phone</span>

            <span class="c1"># send SMS</span>
            <span class="n">send_sms_with_template</span><span class="p">(</span><span class="n">phone</span><span class="p">,</span> <span class="n">tokens</span><span class="p">,</span> <span class="s1">&#39;verification_code&#39;</span><span class="p">)</span>

            <span class="c1"># success message</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;Your verification code has been sent.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;orders:verify_code&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">PhoneVerificationForm</span><span class="p">()</span>

    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;forms/verify_phone.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<blockquote>
<p>ุงฺฏุฑ ฺฉุงุฑุจุฑ ุฏุฑ ูุจุณุงุช ูุงฺฏู ฺฉุฑุฏู ุจุงุดุฏ (ุนู anonymous-user ูุจุงุดุฏ)ุ ูุชุฏ is_authenticated ููุฏุงุฑ True ุฑุง ุจุฑูฺฏุฑุฏุงูุฏ.</p>
</blockquote>
<p>1- ุงฺฏุฑ ฺฉุงุฑุจุฑ ูุงฺฏู ฺฉุฑุฏู ุจุงุดุฏุ ุฏฺฏุฑ ูุงุฒู ูุณุช ฺฉู ุดูุงุฑู ุชููู ูุงุฑุฏ ฺฉูุฏุ ุจูุงุจุฑุงู ุขู ฺฉุงุฑุจุฑ ุฑุง ุจู ุตูุญู ุงุทูุงุนุงุช ฺฏุฑูุฏู ุณูุงุฑุด (ุนู order_create) ููุชูู ูฺฉูู.</p>
<p>2- ููุช ฺฉุงุฑุจุฑ ุดูุงุฑู ุชููู ุฑุง ูุงุฑุฏ ฺฉุฑุฏ ู ุขูุฑุง ุงุฑุณุงู ฺฉุฑุฏุ ุดูุงุฑู ุชููู ุฑุง ุจู ูุฑู ููุฑุณุชู ุชุง ุงุนุชุจุงุฑุณูุฌ ุดูุฏุ ฺูุงูฺู ูุดฺฉู ูุฏุงุดุชู ุจุงุดุฏ ุขูุฑุง ุฏุฑ ฺฉ ูุชุบุฑ ุฐุฎุฑู ูฺฉูู.</p>
<p>3- ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉุชุงุจุฎุงูู random ฺฉ ฺฉุฏ 6 ุฑูู(ุชุนุฏุงุฏ ุงุฑูุงู ุฏูุฎูุงู ุงุณุช) ุงุฌุงุฏ ูฺฉูู ู ุขูุฑุง ุฏุฑ ฺฉ ุฏฺฉุดูุฑ ุฐุฎุฑู ูฺฉูู.</p>
<blockquote>
<p>ุงู ุฏฺฉุดูุฑ ุฑุง ุจู API ุณุฑูุณ ูพุงูฺฉ ุงุฑุณุงู ูฺฉููุ ุชุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุขู ููุฏุงุฑุ ฺฉุฏ ุชุงุฏ ุฑุง ุจู ฺฉุงุฑุจุฑ ุงุฑุณุงู ฺฉูุฏ.</p>
</blockquote>
<p>4- ฺฉุฏ ุชุงุฏ ู ุดูุงุฑู ุชููู ุฑุง ุฏุฑ session ุฐุฎุฑู ูฺฉูู.(ุชุง ุฏุฑ view ูุง ุจุนุฏ ูู ุจู ุขููุง ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดู.)</p>
<p>5- ุดูุงุฑู ุชููู ฺฉุงุฑุจุฑุ ุฏฺฉุดูุฑ tokens ู ุงุณู ุชููพูุช(ููุงู ูุงู ุงูฺฏู ุฏุฑ ุจุฎุด ุงุนุชุจุงุฑุณูุฌ ูุจุณุงุช) ุฑุง ุจู API  ุณุงูุงูู ูพุงูฺฉ ุงุฑุณุงู ูฺฉูู. / ุณุงูุงูู ูพุงูฺฉ ุจุง ุงุณุชูุงุฏู ุงุฒ ุขููุง ูพุงู ุฑุง ุจู ฺฉุงุฑุจุฑ ุงุฑุณุงู ูฺฉูุฏ.</p>
<p>6- ูพุงู "ฺฉุฏ ุชุงุฏ ุจุฑุง ุดูุง ุงุฑุณุงู ุดุฏ" ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงฺูู messages ุจู ฺฉุงุฑุจุฑ ูุดุงู ูุฏูู. / ุฏุฑ ูพุงุงู ฺฉุงุฑุจุฑ ุฑุง ุจู view ุจุนุฏ ุนู verify-code ููุชูู ูฺฉูู.</p>
<p><strong>ุงุฌุงุฏ ุชููพูุช verify_phone.html</strong></p>
<p><code>app (order)/templates/forms/verify_phone.html</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">jinja</span>
        </div>
    <pre><span></span><span class="x">&lt;h2&gt;verification phone&lt;/h2&gt;</span>

<span class="x">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span>

<span class="x">    </span><span class="cp">{{</span> <span class="nv">form.as_p</span> <span class="cp">}}</span>

<span class="x">    &lt;input type=&quot;submit&quot; value=&quot;Send&quot;&gt;</span>
<span class="x">&lt;/form&gt;</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">message</span> <span class="k">in</span> <span class="nv">messages</span> <span class="cp">%}</span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">message</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>

<h3 id="rsl-w-brrsy-khd-tyyd-bh-shmrh-khrbr">ุงุฑุณุงู ู ุจุฑุฑุณ ฺฉุฏ ุชุงุฏ ุจู ุดูุงุฑู ฺฉุงุฑุจุฑ</h3>
<p>ุจุฑุง ฺฉุฏ ุชุงุฏ ููุท ุฏุฑ ุชููพูุช ฺฉ ูุฑู ุงุฌุงุฏ ฺฉุฑุฏู ู ููุงุฏุฑ ุขู ุฑุง ุจุง ุฏุณุชูุฑ <strong>request.POST</strong> ุฏุฑุงูุช ูฺฉูู.</p>
<p><strong>ุงุฌุงุฏ view ุจุฑุง ุฏุฑุงูุช ู ุจุฑุฑุณ ฺฉุฏ ุชุงุฏ:</strong></p>
<p><code>app directory(orders)/views.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="k">def</span> <span class="nf">verify_code</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">received_code</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">received_code</span><span class="p">:</span>
            <span class="n">verification_code</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;verification_code&#39;</span><span class="p">]</span>
            <span class="n">phone</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">received_code</span> <span class="o">==</span> <span class="n">verification_code</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ShopUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">phone</span><span class="o">=</span><span class="n">phone</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="n">user</span> <span class="o">=</span> <span class="n">ShopUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">phone</span><span class="o">=</span><span class="n">phone</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">characters</span> <span class="o">=</span> <span class="s1">&#39;QWERTYUIOPASDFGHJKLZXCVBNM-0123456789-@_qwertyuiopasdfghjklzxcvbnm&#39;</span>
                    <span class="n">user_password</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">characters</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

                    <span class="n">user</span> <span class="o">=</span> <span class="n">ShopUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="n">phone</span><span class="o">=</span><span class="n">phone</span><span class="p">)</span>
                    <span class="n">user</span><span class="o">.</span><span class="n">set_password</span><span class="p">(</span><span class="n">user_password</span><span class="p">)</span>
                    <span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

                    <span class="c1"># send SMS:</span>
                    <span class="n">send_data</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;token1&#39;</span><span class="p">:</span> <span class="n">phone</span><span class="p">,</span>
                        <span class="s1">&#39;token2&#39;</span><span class="p">:</span> <span class="n">user_password</span><span class="p">,</span>
                    <span class="p">}</span>
                    <span class="n">send_sms_with_template</span><span class="p">(</span><span class="n">phone</span><span class="p">,</span> <span class="n">send_data</span><span class="p">,</span> <span class="s1">&#39;create-account&#39;</span><span class="p">)</span>

                <span class="c1"># โโโโโโโโโโโโโโโ login user in website โโโโโโโโโโโโโโโ</span>
                <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>

                <span class="c1"># โโโโโโโโโโ clean code &amp; phone from session โโโโโโโโโโ</span>
                <span class="k">del</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;verification_code&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span>

                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;orders:order_create&#39;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;Your verification code does not match.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;forms/verify_code.html&#39;</span><span class="p">)</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<p>1- ููุช ฺฉุงุฑุจุฑ ฺฉุฏ ุชุงุฏ ุฑุง ุงุฑุณุงู ฺฉุฑุฏุ ุจุง ุฏุณุชูุฑ <strong>request.POST.get('code')</strong> ุขูุฑุง ุฏุฑุงูุช ฺฉุฑุฏู ู ุฏุฑ ฺฉ ูุชุบุฑ ุฐุฎุฑู ูฺฉูู.</p>
<p>2- ฺฉุฏ ุชุงุฏ ู ุดูุงุฑู ุชููู ฺฉุงุฑุจุฑุ ุฑุง ุงุฒ session ุฏุฑุงูุช ฺฉุฑุฏู ู ุฏุฑ ูุชุบุฑ ุฐุฎุฑู ูฺฉูู.</p>
<p>3- ุญุงูุง ุจุฑุฑุณ ูฺฉูู ฺฉู ฺฉุฏ ุชุงุฏ ุงุฑุณุงู ุดุฏู ุชูุณุท ฺฉุงุฑุจุฑ ุจุง ฺฉุฏ ุชุงุฏ ฺฉู ูุง ุจุฑุงุด ุงุฑุณุงู ฺฉุฑุฏู ุชุทุงุจู ุฏุงุฑุฏ ุง ูู!!!</p>
<ul>
<li>
<p>ุงฺฏุฑ ฺฉุฏ ุชุงุฏ ุชุทุงุจู ูุฏุงุดุช ฺฉ ูพุงู ุจู ฺฉุงุฑุจุฑ ูุดุงู ูุฏูู. "ฺฉุฏ ุชุงุฏ ุตุญุญ ููุจุงุดุฏ ุง ุชุทุงุจู ูุฏุงุฑุฏ."</p>
</li>
<li>
<p>ุญุงูุง ุงฺฏุฑ ฺฉุฏ ุชุงุฏ ุฏุฑุณุช ุจูุฏุ ุฏู ุญุงูุช ูุฌูุฏ ุฏุงุฑุฏ ุ ุงฺฏุฑ ฺฉุงุฑุจุฑ ุญุณุงุจ ูุฏุงุฑุฏ ฺฉ ุญุณุงุจ ุจุฑุงุด ุงุฌุงุฏ ูฺฉูู ู ุจุง ุขู ูุงฺฏู ูฺฉูู ูู ุงฺฏุฑ ุญุณุงุจ ุฏุงุดุชู ุจุงุดุฏ ุจุง ููุงู ุญุณุงุจ ูุงฺฏู ูุดูู.</p>
</li>
</ul>
<p>4- ุจุฑุฑุณ ูฺฉูู ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุฑู ุชููู ูุฌู ุฏุงุฑุฏ ุง ูู! ุงฺฏุฑ ูุฌูุฏ ุฏุงุดุช ุงุทูุงุนุงุช ุขู ฺฉุงุฑุจุฑ ุฑุง ุฏุฑ ฺฉ ูุชุบุฑ ุฐุฎุฑู ูฺฉูู ุชุง ุจุชูุงูู ูุงฺฏู ุดูู.</p>
<p>5- ุงฺฏุฑ ฺฉุงุฑุจุฑ ูุฌูุฏ ูุฏุงุดุชุ ฺฉ ุญุณุงุจ ฺฉุงุฑุจุฑ ุจุง ุฑูุฒ ุฑูุฏูู ุจุฑุงุด ุงุฌุงุฏ ฺฉุฑุฏู ู ุขู ุงุทูุงุนุงุช (ูุงู ฺฉุงุฑุจุฑ(ุดูุงุฑู ุชููู) ู ุฑูุฒ ุนุจูุฑ) ุฑุง ุจุฑุงุด ูพุงูฺฉ ูฺฉูู.</p>
<p>6- ฺฉุงุฑุจุฑ ุฑุง ุฏุฑ ูุจุณุงุช ูุงฺฏู ูฺฉูู.</p>
<p>7- ุดูุงุฑู ุชููู ู ฺฉุฏ ุชุงุฏ ุฑุง ุงุฒ session ูพุงฺฉ ฺฉุฑุฏู ู ฺฉุงุฑุจุฑ ุฑุง ุจู ุตูุญู ุชฺฉูู ูุฑู ุงุทูุงุนุงุช ฺฏุฑูุฏู ุณูุงุฑุด(order-create) ููุชูู ูฺฉูู.</p>
<p><strong>ุงุฌุงุฏ ุชููพูุช ุจุฑุง ุฏุฑุงูุช ฺฉุฏ ุชุงุฏ:</strong></p>
<p><code>app (order)/templates/forms/verify_code.html</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">jinja</span>
        </div>
    <pre><span></span><span class="x">&lt;h2&gt;verification code&lt;/h2&gt;</span>

<span class="x">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span>

<span class="x">    &lt;input type=&quot;text&quot; name=&quot;code&quot; placeholder=&quot;Enter your code&quot;&gt;</span>

<span class="x">    &lt;input type=&quot;submit&quot; value=&quot;send&quot;&gt;</span>
<span class="x">&lt;/form&gt;</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">message</span> <span class="k">in</span> <span class="nv">messages</span> <span class="cp">%}</span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">message</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>

<h3 id="dryft-mshkhst-sfrsh-z-khrbr">ุฏุฑุงูุช ูุดุฎุตุงุช ุณูุงุฑุด ุงุฒ ฺฉุงุฑุจุฑ</h3>
<p>ุฏุฑ ุงูพ orderุ ุฏู ูุฏู ุงุฌุงุฏ ฺฉุฑุฏูุ Order(ุงุทูุงุนุช ฺฏุฑูุฏู ุณูุงุฑุด)ุ OrderItem(ุขุชู ูุง ุณูุงุฑุด ููุงู ฺฉุงูุงูุง ุณูุงุฑุด ุฏุงุฏู ุดุฏู)</p>
<blockquote>
<p>ุญุงูุง ฺฉ ูุฑู ุงุฌุงุฏ ูฺฉูู ฺฉู ุงุทูุงุนุงุช ฺฏุฑูุฏู ุณูุงุฑุด ุฑุง ุงุฒ ฺฉุงุฑุจุฑ ุฏุฑุงูุช ูฺฉูุฏ ู ูพุณ ุงุฒ ุขู ุจุฑุงุณุงุณ ุงุทูุงุนุงุช cart(ุณุจุฏ ุฎุฑุฏ) ุขุจุฌฺฉุช ูุง ูุฏู OrderItem ุฑุง ุงุฌุงุฏ ูฺฉูู.</p>
</blockquote>
<p><strong>ุงุฌุงุฏ ูุฑู ุงุทูุงุนุงุช ฺฏุฑูุฏู ุณูุงุฑุด:</strong></p>
<p><code>app directory(orders)/forms.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Order</span>


<span class="k">class</span> <span class="nc">OrderCreateForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Order</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;firstname&#39;</span><span class="p">,</span> <span class="s1">&#39;lastname&#39;</span><span class="p">,</span> <span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="s1">&#39;postal_code&#39;</span><span class="p">,</span> <span class="s1">&#39;province&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">]</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<p>ูุฑู ุฑุง ุงุฒ ููุฏูุง ูุฏู Order ุงุฌุงุฏ ูฺฉูู.</p>
<p><strong>ูฺฉุชู:</strong> ุฏุฑ ุงู ูุฑู ุดูุงุฑู ุชููู ุฑุง ูุฒ ุฏุฑุงูุช ูฺฉููุ ฺูู ุดูุงุฑู ุชููู ฺฏุฑูุฏู ุณูุงุฑุด ูุจุงุดุฏ ู ููฺฉู ุงุณุช ููุงู ุดูุงุฑู ฺฉุงุฑุจุฑ ูุจุงุดุฏ.(ุดูุงุฑู ุง ฺฉู ุจุง ุขู ูุงฺฏู ฺฉุฑุฏู ุงุณุช.)</p>
<p><strong>ุงุฌุงุฏ view ุจุฑุง ูุฑู ุงุทูุงุนุงุช ฺฏุฑูุฏู ุณูุงุฑุด:</strong></p>
<p>ุงู view ุจู url (ุขุฏุฑุณ) order-create ูุชุตู ูุจุงุดุฏ.</p>
<p><code>app directory(orders)/views.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">login_required</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">OrderItem</span><span class="p">,</span> <span class="n">Order</span>
<span class="kn">from</span> <span class="nn">cart.cart</span> <span class="kn">import</span> <span class="n">Cart</span>
<span class="c1"># app &quot;cart&quot; =&gt; &quot;cart.py&quot; file =&gt; &quot;Cart&quot; class</span>


<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">order_create</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">cart</span> <span class="o">=</span> <span class="n">Cart</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">OrderCreateForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
            <span class="c1"># Order Info</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">order</span><span class="o">.</span><span class="n">buyer</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>
            <span class="n">order</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

            <span class="c1"># โโโโโโโโโโโโ Order Item โโโโโโโโโโโโ</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">cart</span><span class="p">:</span>
                <span class="n">OrderItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                    <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
                    <span class="n">product</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;product&#39;</span><span class="p">],</span>
                    <span class="n">price</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span>
                    <span class="n">quantity</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;quantity&#39;</span><span class="p">],</span>
                    <span class="n">weight</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="c1"># โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ</span>

            <span class="c1"># clean cart</span>
            <span class="n">cart</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;order_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">id</span>

            <span class="c1"># ุงูุชูุงู ุจู ุตูุญู ูพุฑุฏุงุฎุช ูุฒูู ุณูุงุฑุด</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;orders:request&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">OrderCreateForm</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;forms/order_create.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">,</span> <span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="n">cart</span><span class="p">})</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<p>1- ุจุฑุง ุงู view ุงุฒ ุฏฺฉูุฑุงุชูุฑ <strong>login_required</strong> ุงุณุชูุงุฏู ูฺฉููุ ฺูู ุจุฑุง ุงู ุตูุญู ฺฉุงุฑุจุฑ ุจุงุฏ ุฏุฑ ูุจุณุงุช ูุงฺฏู ฺฉุฑุฏู ุจุงุดุฏ.</p>
<p>2- ฺฉ ุขุจุฌฺฉุช ุงุฒ ฺฉูุงุณ Cart ุงุฌุงุฏ ูฺฉูู. / ุจุง ุงุณุชูุงุฏู ุงุฒ ุขู ุขุจุฌฺฉุช ูุง OrderItem ุฑุง ุงุฌุงุฏ ูฺฉูู.</p>
<p>3- ุงุทูุงุนุงุช ฺฏุฑูุฏู ุณูุงุฑุด ุฑุง ุง ุชููพูุช ุฏุฑุงูุช ฺฉุฑุฏู ู ููุฏูุง ุขูุฑุง ุงุนุชุจุงุฑุณูุฌ ูฺฉูู.</p>
<p>4- ฺูุงูฺู ููุฏูุง ูุดฺฉู ูุฏุงุดุชู ุจุงุดูุฏุ ุจุง ูุชุฏ save ุงุทูุงุนุงุช ุณูุงุฑุด ุฑุง ุจู ููุฑุงู ฺฉุงุฑุจุฑ ูุนู ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ูฺฉูู.</p>
<p>5- ุฑู ุขุจุฌฺฉุช cart ุญููู ูุฒูู ู ุจุฑุงุณุงุณ ุงุทูุงุนุงุช ุขูุ ุจุฑุง ูุฏู OrderItem ุขุจุฌฺฉุช ูุง ูุฑุจูุท ุจู ุณูุงุฑุด ูุนู ุฑุง ุงุฌุงุฏ ูฺฉูู.</p>
<blockquote>
<p>ููุช ุฑู ุขุจุฌฺฉุช cart ุญููู ูุฒููุ ุฏุฑ ูุฑ ุงุชุฑุดู ฺฉ ูุญุตูู ุงุฒ ุณุจุฏ ุฎุฑุฏ ุจุง ุงุทูุงุนุงุช ูุธุฑ ุชุนุฏุงุฏ ฺฉุงูุงุ ููุช ฺฉุงูุงุ ู... ุฑุง ุจุฑูฺฏุฑุฏุงูุฏ.</p>
<p>ูุฑ item ฺฉ ุฏฺฉุดูุฑ ุงุฒ ุงุทูุงุนุงุช ูุญุตูู ูุจุงุดุฏ. / ุจุง ุชูุฌู ุจู ูุฑ ุขุชู ฺฉ ุขุจุฌฺฉุช ุจุฑุง ูุฏู OrderItem ุงุฌุงุฏ ูฺฉูู.</p>
</blockquote>
<p>6- ุงุทูุงุนุงุช cart (ุณุจุฏ ุฎุฑุฏ) ุฑุง ุจุง ูุชุฏ clear ูพุงฺฉ ูฺฉูู.</p>
<p>7- ุขุฏ ุณูุงุฑุด (order_id) ุฑุง ุฏุฑ session ุฐุฎุฑู ูฺฉูู. / ุฏุฑ view ูุง ุจุนุฏ ุงุณุชูุงุฏู ูุดูุฏ.</p>
<p>8- ฺฉุงุฑุจุฑ ุฑุง ุจู ุตูุญู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ููุชูู ูฺฉูู. / ุฏุฑ ุงุฏุงูู url ู view ุขูุฑุง ุงุฌุงุฏ ูฺฉูู.</p>
<p><strong>ุงุฌุงุฏ ุชููพูุช ูุฑู ุงุทูุงุนุงุช ฺฏุฑูุฏู ุณูุงุฑุด:</strong></p>
<p><code>app(orders)/templates/forms/order_create.html</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">jinja</span>
        </div>
    <pre><span></span><span class="x">&lt;h2&gt;Your chosen products&lt;/h2&gt;</span>

<span class="x">&lt;ul&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="k">in</span> <span class="nv">cart</span> <span class="cp">%}</span>
<span class="x">        &lt;li&gt;</span>
<span class="x">            </span><span class="cp">{{</span> <span class="nv">item.quantity</span> <span class="cp">}}</span><span class="x"> X </span><span class="cp">{{</span> <span class="nv">item.product.name</span> <span class="cp">}}</span><span class="x"> =&gt;</span>
<span class="x">            </span><span class="cp">{{</span> <span class="nv">item.total</span> <span class="cp">}}</span>
<span class="x">        &lt;/li&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="x">&lt;/ul&gt;</span>

<span class="x">&lt;!-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ --&gt;</span>

<span class="x">&lt;h2&gt;Complete the order information&lt;/h2&gt;</span>

<span class="x">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span>
<span class="x">    </span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">form.as_p</span> <span class="cp">}}</span>

<span class="x">    &lt;input type=&quot;submit&quot; value=&quot;send&quot;&gt;</span>
<span class="x">&lt;/form&gt;</span>
</pre></div>

<h3 id="tsl-drgh-prdkht-zryn-pl-bh-frwshgh">ุงุชุตุงู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช (ุฒุฑู ูพุงู) ุจู ูุฑูุดฺฏุงู</h3>
<p>ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฏุฑฺฏุงู ูพุฑุฏุงุฎุชุ ุฏุฑ ุขู ูุจุณุงุช ุซุจุช ูุงู ฺฉุฑุฏู ู ุนููุงุช ุงุญุฑุงุฒ ููุช ุฑุง ุชฺฉูู ูฺฉูู.</p>
<p>ูุงุฒู ุงุณุช ฺฉุณุฑ ุชูุธูุงุช ุฑุง ุฏุฑ <strong>settings.py</strong> ูพุงุฏู ุณุงุฒ ฺฉูู:</p>
<p><code>project directory/settings.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="c1"># ZarinPal Info</span>
<span class="n">MERCHANT</span> <span class="o">=</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span>
<span class="n">SANDBOX</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<ul>
<li>
<p>ููุช ุจุฑุง ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ุซุจุช ูุงู ฺฉุฑุฏูุ ุชู ุชูุธูุงุช ฺฉ ฺฉุฏ ุจุฑุง ูุง ุงุฌุงุฏ ูุดูุฏุ ุขูุฑุง ุจุฑุง ูุชุบุฑ MERCHANT ุณุช ูฺฉูู. / ุงู ููุฏุงุฑ ูุนู ุณุงุฎุชุงุฑ ุขูุฑุง ูุดุงู ูุฏูุฏ.</p>
</li>
<li>
<p>ุจุฑุง SANDBOX ููุฏุงุฑ False ุฑุง ูุดุฎุต ูฺฉููุ ุชุง ุงุฒ ุชูุธูุงุช ูพุดูุฑุถ ุงุณุชูุงุฏู ูฺฉูุฏ.</p>
</li>
</ul>
<blockquote>
<p>ุฏุฑ ุตูุฑุช ูุจูุฏ ูุงฺูู <strong>requests</strong> ุขูุฑุง ูุตุจ ูฺฉูู.</p>
<p>pip install requests</p>
</blockquote>
<p><strong>ุงุฌุงุฏ url ูุง ูุฑุจูุท ุจู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช:</strong></p>
<p>ุฏู ุชุง url ุจู url ูุง ุงูพ orders ุงุถุงูู ูฺฉูู.</p>
<p><code>app directory(orders)/urls.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ...</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;request/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">send_request</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;request&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;verify/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">verify</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;verify&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>

<blockquote>
<p>view ูุง ูุฑุจูุท ุจู ุงู ุฏู url  ุฑุง ูู ุงุฌุงุฏ ูฺฉูู.</p>
<p>ุงูู ุจุฑุง ูุฑุงุญู ูุจู ุงุฒ ูุฑูุฏ ุจู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ูุณุช ู ุฏฺฏุฑ ูุฑุงุญู ุจุนุฏ ุงุฒ ุงูฺฉู ุงุฒ ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ุจุฑูฺฏุฑุฏุฏ.</p>
</blockquote>
<p><strong>ุงุฌุงุฏ view ูุง ูุฑุจูุท ุจู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช:</strong></p>
<p>ุงู ุฏุงุฏู ูุง ุฑุง ุงุฒ ฺฏุชูุงุจ ฺฉู ุฏุฑ ุณุงุช ุฒุฑู ูพุงู ฺฏูุชู ุดุฏู ุจุฑูุฏุงุฑูุ ูู ุณุงุฎุชุงุฑ ุขููุง ุงุฑุงุฏุงุช ุฏุงุฑู ุจูุงุจุฑุงู ุงุฒ ูุณุฎู ูุฑุงุด ุดุฏู ุฏุฑ pull request ุขู  ุงุณุชูุงุฏู ูฺฉูู ฺฉู ุขู ูู ุจุงุฒ ูุงุฒ ุจู ุชุบุฑุงุช ุฏุงุฑุฏ.</p>
<p><code>github(zarinpal)</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>


<span class="c1">#? sandbox merchant </span>
<span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">SANDBOX</span><span class="p">:</span>
    <span class="n">sandbox</span> <span class="o">=</span> <span class="s1">&#39;sandbox&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">sandbox</span> <span class="o">=</span> <span class="s1">&#39;www&#39;</span>


<span class="n">ZP_API_REQUEST</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">sandbox</span><span class="si">}</span><span class="s2">.zarinpal.com/pg/rest/WebGate/PaymentRequest.json&quot;</span>
<span class="n">ZP_API_VERIFY</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">sandbox</span><span class="si">}</span><span class="s2">.zarinpal.com/pg/rest/WebGate/PaymentVerification.json&quot;</span>
<span class="n">ZP_API_STARTPAY</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">sandbox</span><span class="si">}</span><span class="s2">.zarinpal.com/pg/StartPay/&quot;</span>

<span class="n">amount</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Rial / Required</span>
<span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;ุชูุถุญุงุช ูุฑุจูุท ุจู ุชุฑุงฺฉูุด ุฑุง ุฏุฑ ุงู ูุณูุช ูุงุฑุฏ ฺฉูุฏ&quot;</span>  <span class="c1"># Required</span>
<span class="n">phone</span> <span class="o">=</span> <span class="s1">&#39;YOUR_PHONE_NUMBER&#39;</span>  <span class="c1"># Optional</span>
<span class="c1"># Important: need to edit for real server.</span>
<span class="n">CallbackURL</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:8080/verify/&#39;</span>


<span class="k">def</span> <span class="nf">send_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;MerchantID&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">MERCHANT</span><span class="p">,</span>
        <span class="s2">&quot;Amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
        <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
        <span class="s2">&quot;Phone&quot;</span><span class="p">:</span> <span class="n">phone</span><span class="p">,</span>
        <span class="s2">&quot;CallbackURL&quot;</span><span class="p">:</span> <span class="n">CallbackURL</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># set content length by data</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-length&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">ZP_API_REQUEST</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">authority</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;Authority&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">ZP_API_STARTPAY</span><span class="o">+</span><span class="n">authority</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;response failed&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Timeout Error&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Connection Error&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">authority</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Authority&#39;</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Status&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;OK&#39;</span> <span class="ow">and</span> <span class="n">authority</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;MerchantID&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">MERCHANT</span><span class="p">,</span>
            <span class="s2">&quot;Amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
            <span class="s2">&quot;Authority&quot;</span><span class="p">:</span> <span class="n">authority</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># set content length by data</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-length&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">ZP_API_VERIFY</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="n">reference_id</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;RefID&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;successful , RefID: </span><span class="si">{</span><span class="n">reference_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;response failed&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Timeout Error&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Connection Error&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Not ok&#39;</span><span class="p">)</span>
</pre></div>

<p><strong>ุจุฑู ุงู ุฏู ุชุง view ุฑุง ุชุบุฑ ุจุฏู:</strong></p>
<p>1- amount, description, phone ููุฏุงุฑ ุซุงุจุช ูุฏุงุฑูุฏ ูพุณ ุขููุง ุฑุง ุฏุฑ view ูุง ุชุนุฑู ูฺฉูู ูู ุจู ุตูุฑุช ฺฉ ูุชุบุฑ.</p>
<p>2- ุจุฑุง CallbackURL ุจุงุฏ ุขุฏุฑุณ ุญูู ูุจุณุงุช ุฑุง ูุงุฑุฏ ฺฉูู ูู ุฏุฑ ุญุงู ุญุงุถุฑ ุงุฒ ุขุฏุฑุณ local-host ุจุง ูพูุฑุช 8000 ุงุณุชูุงุฏู ูฺฉูู.</p>
<blockquote>
<p><span class="rtl-text"><strong>ูฺฉุชู:</strong> ุงฺฏุฑ ุงุฏุชุงู ุจุงุดุฏ ุฏุฑ ูุงู urls.py ูพุฑูฺู ุจุฑุง url ูุง ุงูพ order ูุดุฎุต ฺฉุฑุฏู ฺฉู ุจุง ุนุจุงุฑุช <span class="en-text">order/</span> ุดุฑูุน ุดููุฏ ุฏุฑ ูุชุฌู ุจุงุฏ order ุฑุง ูุจู ุงุฒ verify ุงุถุงูู ฺฉูู.</span></p>
<p><span class="rtl-text">ูพุณ ุงูุฌุง url ูุง ูุดูุฏ <span class="en-text">http://127.0.0.1:8000/order/verify/</span></span></p>
</blockquote>
<p><strong>ุงุฌุงุฏ ุชุบุฑุงุช ุฏุฑ ูู send_request:</strong></p>
<p>1- ููุงุฏุฑ ูุงุฒู ุฑุง ุงุฒ ุขุจุฌฺฉุช ุณูุงุฑุด ูุนู ูฺฏุฑูุ ุจูุงุจุฑุงู ุจุง ุงุณุชูุงุฏู ุงุฒ ุขุฏ ุณูุงุฑุด (order_id) ฺฉู ุฏุฑ view ูุจู ุฏุฑ ุณุดู ุฐุฎุฑู ฺฉุฑุฏู ุขุจุฌฺฉุช ุณูุงุฑุด ุฑุง ุงุฒ ุฏุชุงุจุณ ุฏุฑุงูุช ูฺฉูู.</p>
<p>2- ุจุฑุง ุชูุถุญุงุช ุณูุงุฑุด ุงุณู ูุญุตููุงุช ุฎุฑุฏุงุฑ ุดุฏู ุฑุง ููุงุด ูุฏูู./ ุฑู order-item ูุง ุงู ุณูุงุฑุด ุญููู ูุฒูู ู ุงุณู ูุญุตูู ุฑุง ุจู ุตูุฑุช ุฑุดุชู ุฐุฎุฑู ูฺฉูู.</p>
<p>3- <strong>Amount:</strong> ูุฒูู ููุง ุฌูุช ูพุฑุฏุงุฎุช ูุจุงุดุฏ(ูุฒูู ูุญุตููุงุช + ูุฒูู ูพุณุช)ุ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ <span class="en-text">get_final_cost()</span> ุจุฑุง ุขุจุฌฺฉุช order ุขูุฑุง ุจุฏุณุช ู ุขูุฑู.</p>
<p>4- ุดูุงุฑู ุชููู ุฎุฑุฏุงุฑ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ request.user.phone ูุดุฎุต ูฺฉูู.</p>
<p><strong>ุงุฌุงุฏ ุชุบุฑุงุช ุฏุฑ ูู verify:</strong></p>
<p>1- ุฏุฑ ุงู view ูู ุจุง ุงุณุชูุงุฏู ุงุฒ order_id ุขุจุฌฺฉุช ุณูุงุฑุด ูุนู ุฑุง ุฏุฑ ฺฉ ูุชุบุฑ ุฐุฎุฑู ูฺฉูู.</p>
<p>2- ููุฏุงุฑ <strong>Amount</strong> ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ <span class="en-text">get_final_cost()</span> ูุญุงุณุจู ูฺฉูู.</p>
<p>3- <span class="rtl-text"> ุดุฑุท <code>if response['Status'] == 100</code> ุจุงุฏ ุจู <code>if response_json['Status'] == 100</code> ุชุบุฑ ฺฉูุฏ.</span></p>
<p>4- ููุช ฺฉุฏ ูุถุนุช 100 ูุณุชุ ุนู ูพุฑุฏุงุฎุช ูููู ุจูุฏู ุจูุงุจุฑุงู ุจุงุฏ <strong>ููุฌูุฏ ุขู ูุญุตููุงุช</strong> ู ูุฒ <strong>ูุถุนุช ูพุฑุฏุงุฎุช ฺฉุงุฑุจุฑ</strong> ุชุบุฑ ฺฉูุฏ.</p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="k">if</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
    <span class="c1"># change inventory of products</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">inventory</span> <span class="o">-=</span> <span class="n">item</span><span class="o">.</span><span class="n">quantity</span>
        <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="c1"># change paid status...</span>
    <span class="n">order</span><span class="o">.</span><span class="n">paid</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">order</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>

<p><strong>ูุณุฎู ุชุบุฑ ุงูุชู view ูุง ูุฑุจูุท ุจู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช:</strong></p>
<p>ุฏุฑ ุงู ูุณุฎู ุชุบุฑุงุช ฺฉู ุฏุฑ ุจุงูุง ุชูุถุญ ุฏุงุฏู ุงุนูุงู ุดุฏู ุงูุฏ.</p>
<p><code>app directory(orders)/views.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="c1"># zarin pal info : ุงุทูุงุนุงุช ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช</span>

<span class="c1"># ? sandbox merchant</span>
<span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">SANDBOX</span><span class="p">:</span>
    <span class="n">sandbox</span> <span class="o">=</span> <span class="s1">&#39;sandbox&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">sandbox</span> <span class="o">=</span> <span class="s1">&#39;www&#39;</span>


<span class="n">ZP_API_REQUEST</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">sandbox</span><span class="si">}</span><span class="s2">.zarinpal.com/pg/rest/WebGate/PaymentRequest.json&quot;</span>
<span class="n">ZP_API_VERIFY</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">sandbox</span><span class="si">}</span><span class="s2">.zarinpal.com/pg/rest/WebGate/PaymentVerification.json&quot;</span>
<span class="n">ZP_API_STARTPAY</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">sandbox</span><span class="si">}</span><span class="s2">.zarinpal.com/pg/StartPay/&quot;</span>


<span class="c1"># Important: need to edit for real server.</span>
<span class="n">CallbackURL</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:8000/order/verify/&#39;</span>


<span class="k">def</span> <span class="nf">send_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;order_id&#39;</span><span class="p">))</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">description</span> <span class="o">+=</span> <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;MerchantID&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">MERCHANT</span><span class="p">,</span>
        <span class="s2">&quot;Amount&quot;</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">get_final_cost</span><span class="p">(),</span>
        <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
        <span class="s2">&quot;Phone&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">phone</span><span class="p">,</span>
        <span class="s2">&quot;CallbackURL&quot;</span><span class="p">:</span> <span class="n">CallbackURL</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># set content length by data</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-length&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">ZP_API_REQUEST</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">authority</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;Authority&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">ZP_API_STARTPAY</span><span class="o">+</span><span class="n">authority</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;response failed&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Timeout Error&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Connection Error&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;order_id&#39;</span><span class="p">))</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;MerchantID&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">MERCHANT</span><span class="p">,</span>
        <span class="s2">&quot;Amount&quot;</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">get_final_cost</span><span class="p">(),</span>
        <span class="s2">&quot;Authority&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Authority&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># set content length by data</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-length&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">ZP_API_VERIFY</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">reference_id</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;RefID&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">inventory</span> <span class="o">-=</span> <span class="n">item</span><span class="o">.</span><span class="n">quantity</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

                <span class="c1"># change paid status...</span>
                <span class="n">order</span><span class="o">.</span><span class="n">paid</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">order</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

                <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;successful , RefID: </span><span class="si">{</span><span class="n">reference_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>

        <span class="c1"># clean Order-Id from session</span>
        <span class="k">del</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;order_id&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;response failed&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Timeout Error&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Connection Error&#39;</span><span class="p">)</span>
</pre></div>

<h3 id="sfht-wd-yt-prdkht-lyst-w-jzyyt-sfrsh">ุตูุญุงุช ูุถุนุช ูพุฑุฏุงุฎุชุ ูุณุช ู ุฌุฒุฆุงุช ุณูุงุฑุด</h3>
<p>ุจุฑุง ูุถุนุช ูพุฑุฏุงุฎุช ฺฉุงุฑุจุฑ(ูพุฑุฏุงุฎุช ูููู ู ุง ุฒูุงูฺฉู ูพุฑุฏุงุฎุช ุจุง ุดฺฉุณุช ููุงุฌู ูุดูุฏ) ฺฉ ุชููพูุช ุงุฌุงุฏ ูฺฉูู. / ุงู ุชููพูุช ุจุฌุง HttpResponse ุฏุฑ ูู verify ููุงุด ุฏุงุฏู ูุดูุฏ.</p>
<p><strong>ุงุนูุงู ุชุบุฑุงุช ุฏุฑ ูู ูุฑุจูุท ุจู verify:</strong></p>
<p><code>app directory(orders)/views.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;order_id&#39;</span><span class="p">))</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;MerchantID&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">MERCHANT</span><span class="p">,</span>
        <span class="s2">&quot;Amount&quot;</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">get_final_cost</span><span class="p">(),</span>
        <span class="s2">&quot;Authority&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Authority&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># set content length by data</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;content-length&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">ZP_API_VERIFY</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">reference_id</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;RefID&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">inventory</span> <span class="o">-=</span> <span class="n">item</span><span class="o">.</span><span class="n">quantity</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

                <span class="c1"># change paid status...</span>
                <span class="n">order</span><span class="o">.</span><span class="n">paid</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">order</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

                <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;orders/payment-tracking.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;RefID&#39;</span><span class="p">:</span> <span class="n">reference_id</span><span class="p">,</span> <span class="s1">&#39;order_id&#39;</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">id</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;orders/payment-tracking.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

        <span class="c1"># clean Order-Id from session</span>
        <span class="k">del</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;order_id&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;response failed&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Timeout Error&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Connection Error&#39;</span><span class="p">)</span>
</pre></div>

<p><strong>ุงุฌุงุฏ ุชููพูุช ูุถุนุช ูพุฑุฏุงุฎุช ฺฉุงุฑุจุฑ:</strong></p>
<p><code>app(orders)/templates/orders/payment-tracking.html</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">jinja</span>
        </div>
    <pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;parent/base/base_template.html&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span><span class="x">payment</span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">success</span> <span class="cp">%}</span>
<span class="x">        &lt;div class=&quot;success&quot;&gt;</span>
<span class="x">            &lt;h2&gt;ูพุฑุฏุงุฎุช ูููู&lt;/h2&gt;</span>

<span class="x">            &lt;p&gt;ุดูุงุฑู ูพฺฏุฑ: </span><span class="cp">{{</span> <span class="nv">RefID</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
<span class="x">            &lt;p&gt;ุดูุงุฑู ุณูุงุฑุด: </span><span class="cp">{{</span> <span class="nv">order_id</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">    </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
<span class="x">        &lt;div class=&quot;failure&quot;&gt;</span>
<span class="x">            &lt;h2&gt;ูพุฑุฏุงุฎุช ูุงูููู&lt;/h2&gt;</span>
<span class="x">            &lt;p&gt;ูพุฑุฏุงุฎุช ุจุง ุดฺฉุณุช ููุงุฌู ุดุฏ.&lt;/p&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

<span class="x">    &lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;shop:products-list&#39;</span> <span class="cp">%}</span><span class="x">&quot; class=&quot;back-btn&quot;&gt;ุจุงุฒฺฏุดุช ุจู ูุณุช ูุญุตููุงุช&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>

<p><strong>ุงุฌุงุฏ url  ุจุฑุง ุตูุญุงุช (ูุณุช ุณูุงุฑุดุงุช ู ุฌุฒุฆุงุช ูุฑ ุณูุงุฑุด):</strong></p>
<p><code>app directory(orders)/urls.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ...</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;orders-list/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">orders_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;orders_list&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;order-detail/&lt;int:order_id&gt;/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">order_detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;order_detail&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>

<p><strong>ุงุฌุงุฏ view  ุจุฑุง ุตูุญุงุช (ูุณุช ุณูุงุฑุดุงุช ู ุฌุฒุฆุงุช ูุฑ ุณูุงุฑุด):</strong></p>
<p><code>app directory(orders)/views.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="k">def</span> <span class="nf">orders_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>
    <span class="n">orders</span> <span class="o">=</span> <span class="n">Order</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">buyer</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>

    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;orders&#39;</span><span class="p">:</span> <span class="n">orders</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;orders/order_list.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

<span class="c1"># โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ</span>

<span class="k">def</span> <span class="nf">order_detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">order_id</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">order_id</span><span class="p">)</span>
    <span class="n">order_items</span> <span class="o">=</span> <span class="n">OrderItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>

    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="n">order</span><span class="p">,</span>
        <span class="s1">&#39;order_items&#39;</span><span class="p">:</span> <span class="n">order_items</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;orders/order_detail.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<p>1- ุฏุฑ view ูุณุช ุณูุงุฑุดุงุชุ ุชูุงู ุณูุงุฑุดุงุช ูุฑุจูุท ุจู ฺฉุงุฑุจุฑ ูุนู ูุจุณุงุช ุฑุง ุงุฒ ุฏุชุงุจุณ ุฏุฑุงูุช ฺฉุฑุฏู ู ุฏุฑ ฺฉ ูุชุบุฑ ุฐุฎุฑู ูฺฉููุ ุขูุฑุง ุจู ุชููพูุช ุงุฑุณุงู ฺฉุฑุฏู ู ุจุง ุงุณุชูุงุฏู ุงุฒ ุญููู ุณูุงุฑุดุงุช ฺฉุงุฑุจุฑ ุฑุง ุฏุฑ ุขู ุตูุญู ููุงุด ูุฏูู.</p>
<p>2- ุฏุฑ view  ุฌุฒุฆุงุช ูุฑ ุณูุงุฑุดุ ุจุง ุชูุฌู ุจู ุขุฏ ุณูุงุฑุดุ ุขู ุณูุงุฑุด ุฑุง ุงุฒ ุฏุชุงุจุณ ุฏุฑุงูุช ูฺฉููุ ุขุชู ูุง ุขู ุณูุงุฑุด ุฑุง ูู ุฏุฑุงูุช ูฺฉูู ุชุง ุขููุง ุฑุง ุฏุฑ ุชููพูุช ููุงุด ุฏูู.</p>
<p><strong>ุงุฌุงุฏ ุชููพูุช ุจุฑุง ููุงุด ูุณุช ุณูุงุฑุดุงุช ฺฉุงุฑุจุฑ:</strong></p>
<p><code>app(orders)/templates/orders/order_list.html</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">jinja</span>
        </div>
    <pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;parent/base/base_template.html&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span><span class="x">order&#39;s list</span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
<span class="x">    &lt;h1&gt;ูุณุช ุณูุงุฑุดุงุช&lt;/h1&gt;</span>

<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">orders</span> <span class="cp">%}</span>
<span class="x">        &lt;table&gt;</span>
<span class="x">            &lt;thead&gt;</span>
<span class="x">                &lt;tr&gt;</span>
<span class="x">                    &lt;th&gt;ุดูุงุฑู ุณูุงุฑุด&lt;/th&gt;</span>
<span class="x">                    &lt;th&gt;ุชุงุฑุฎ ุณูุงุฑุด&lt;/th&gt;</span>
<span class="x">                    &lt;th&gt;ูุถุนุช ุณูุงุฑุด&lt;/th&gt;</span>
<span class="x">                &lt;/tr&gt;</span>
<span class="x">            &lt;/thead&gt;</span>

<span class="x">            &lt;tbody&gt;</span>
<span class="x">                </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">order</span> <span class="k">in</span> <span class="nv">orders</span> <span class="cp">%}</span>
<span class="x">                    &lt;tr&gt;</span>
<span class="x">                        &lt;td&gt;&lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;orders:order_detail&#39;</span> <span class="nv">order.id</span> <span class="cp">%}</span><span class="x">&quot;&gt;</span><span class="cp">{{</span> <span class="nv">order.id</span> <span class="cp">}}</span><span class="x">&lt;/a&gt;&lt;/td&gt;</span>

<span class="x">                        &lt;td&gt;</span><span class="cp">{{</span> <span class="nv">order.created</span> <span class="cp">}}</span><span class="x">&lt;/td&gt;</span>

<span class="x">                        </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">order.paid</span> <span class="cp">%}</span>
<span class="x">                            &lt;td&gt;ูพุฑุฏุงุฎุช ูููู โ๏ธ&lt;/td&gt;</span>
<span class="x">                        </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
<span class="x">                            &lt;td&gt;ูพุฑุฏุงุฎุช ูุงูููู โ๏ธ&lt;/td&gt;</span>
<span class="x">                        </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="x">                    &lt;/tr&gt;</span>
<span class="x">                </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="x">            &lt;/tbody&gt;</span>
<span class="x">        &lt;/table&gt;</span>

<span class="x">    </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
<span class="x">        ูฺ ุณูุงุฑุด ุซุจุช ูุดุฏู ุงุณุช!</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>

<p><strong>ุงุฌุงุฏ ุชููพูุช ุจุฑุง ููุงุด ุฌุฒุฆุงุช ูุฑ ุณูุงุฑุด:</strong></p>
<p><code>app(orders)/templates/orders/order_detail.html</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">jinja</span>
        </div>
    <pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;parent/base/base_template.html&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span><span class="x">order detail</span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
<span class="x">    &lt;h1&gt;ุณูุงุฑุด </span><span class="cp">{{</span> <span class="nv">order.id</span> <span class="cp">}}</span><span class="x">&lt;/h1&gt;</span>

<span class="x">    &lt;h2&gt;order item&#39;s&lt;/h2&gt;</span>
<span class="x">    &lt;div class=&quot;products&quot;&gt;</span>
<span class="x">        </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">order_item</span> <span class="k">in</span> <span class="nv">order_items</span> <span class="cp">%}</span>
<span class="x">            &lt;div class=&quot;product&quot;&gt;</span>
<span class="x">                &lt;img src=&quot;</span><span class="cp">{{</span> <span class="nv">order_item.product.images.first.image_file.url</span> <span class="cp">}}</span><span class="x">&quot; alt=&quot;&quot; width=&quot;150px&quot;&gt;</span>
<span class="x">                &lt;h3&gt;</span><span class="cp">{{</span> <span class="nv">order_item.product.name</span> <span class="cp">}}</span><span class="x">&lt;/h3&gt;</span>

<span class="x">                &lt;span&gt;</span><span class="cp">{{</span> <span class="nv">order_item.quantity</span> <span class="cp">}}</span><span class="x"> X </span><span class="cp">{{</span> <span class="nv">order_item.price</span> <span class="cp">}}</span><span class="x"> =&gt; </span><span class="cp">{{</span> <span class="nv">order_item.get_cost</span> <span class="cp">}}</span><span class="x">&lt;/span&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">            &lt;hr&gt;</span>
<span class="x">        </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="x">        </span>
<span class="x">    &lt;/div&gt;</span>

<span class="x">    &lt;hr&gt;</span>

<span class="x">    &lt;div class=&quot;info&quot;&gt;</span>
<span class="x">        &lt;h2&gt;order info&lt;/h2&gt;</span>

<span class="x">        &lt;p&gt;first name: </span><span class="cp">{{</span> <span class="nv">order.firstname</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
<span class="x">        &lt;p&gt;last name: </span><span class="cp">{{</span> <span class="nv">order.lastname</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
<span class="x">        &lt;p&gt;phone: </span><span class="cp">{{</span> <span class="nv">order.phone</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>

<span class="x">        &lt;p&gt;province: </span><span class="cp">{{</span> <span class="nv">order.province</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
<span class="x">        &lt;p&gt;city: </span><span class="cp">{{</span> <span class="nv">order.city</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
<span class="x">        &lt;p&gt;full address: </span><span class="cp">{{</span> <span class="nv">order.address</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
<span class="x">        &lt;p&gt;postal code: </span><span class="cp">{{</span> <span class="nv">order.postal_code</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>

<h3 id="qblyt-khrwjy-fyl-excel-z-sfrsh-h-dr-pnl-dmyn">ูุงุจูุช ุฎุฑูุฌ ูุงู Excel ุงุฒ ุณูุงุฑุด ูุง ุฏุฑ ูพูู ุงุฏูู</h3>
<p>ูุฎูุงูู ุงฺฉุดู ุงุฌุงุฏ ฺฉูู ฺฉู ุงุทูุงุนุงุช ุณูุงุฑุด ูุง ุฑุง ุจู ุตูุฑุช Excel ุฏุฑ ุฎุฑูุฌ ุชุญูู ุฏูุฏ.</p>
<blockquote>
<p>ุจุฑุง ุงู ฺฉุงุฑ ูุงุฒู ุงุณุช ฺฉู ูพฺฉุฌ <strong>openpyxl</strong> ุฑุง ูุตุจ ฺฉูู.</p>
</blockquote>
<p><code>terminal</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">terminal</span>
        </div>
    <pre><span></span>pip install openpyxl
</pre></div>

<p><strong>ุจุฑู ุงฺฉุดู ุฑุง ุฏุฑ ูุงู admin.py ุงุฌุงุฏ ฺฉูู:</strong></p>
<p>ูุงุฒู ุงุณุช ฺฉู HttpResponse ู openpyxl ุฑุง ุงููพูุฑุช ฺฉูู.</p>
<p><code>app directory(orders)/admin.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">import</span> <span class="nn">openpyxl</span>


<span class="c1"># ------------------------------- My Actions -------------------------------</span>
<span class="k">def</span> <span class="nf">export_to_excel</span><span class="p">(</span><span class="n">modeladmin</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queryset</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">)</span>
    <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=&quot;orders.xlsx&quot;&#39;</span>

    <span class="c1"># ---------------------------</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">Workbook</span><span class="p">()</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Orders&#39;</span>
    <span class="c1"># ---------------------------</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;First Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Last Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Phone&#39;</span><span class="p">,</span> <span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="s1">&#39;Postal Code&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="s1">&#39;Province&#39;</span><span class="p">,</span> <span class="s1">&#39;Paid&#39;</span><span class="p">,</span> <span class="s1">&#39;Created&#39;</span><span class="p">]</span>

    <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
    <span class="c1"># ---------------------------</span>
    <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">:</span>
        <span class="n">created</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">created</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">created</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

        <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">order</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">firstname</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">lastname</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">phone</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">postal_code</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">city</span><span class="p">,</span>
               <span class="n">order</span><span class="o">.</span><span class="n">province</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">paid</span><span class="p">,</span> <span class="n">created</span><span class="p">]</span>

        <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="c1"># --------------------------</span>
    <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>


<span class="n">export_to_excel</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s1">&#39;export to excel&#39;</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<blockquote>
<p>ุงู ุงฺฉุดู ุจู ูุฏุฑ ุณุงุช ุงูฺฉุงู ูโุฏูุฏ ุชุง ุฏุงุฏูโูุง ฺฉ queryset (ูุฌููุนูโุง ุงุฒ ุฏุงุฏูโูุง ฺฉู ุงุฒ ฺฉ ูุฏู ุฎุงุต ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุฌูฺฏู ุงูุชุฎุงุจ ุดุฏูโุงูุฏ) ุฑุง ุจู ุตูุฑุช ฺฉ ูุงู Excel (ุจุง ูพุณููุฏ .xlsx) ุฏุงูููุฏ ฺฉูุฏ.</p>
</blockquote>
<p>1- <strong>ููุดุชู ุงฺฉุดู:</strong> ุจุฑุง ููุดุชู ุงฺฉุดูุ ฺฉ ุชุงุจุน ุงุฌุงุฏ ูฺฉูู ฺฉู modeladmin, request, queryset ุฑุง ุจู ุนููุงู <strong>ูพุงุฑุงูุชุฑ</strong> ุฏุฑุงูุช ูฺฉูุฏ.</p>
<ul>
<li>
<p><strong>modeladmin:</strong> ุงุฑุฌุงุน ูุฏูุฏ ุจู ฺฉูุงุณ modeladmin.(ฺฉ ููููู ุงุฒ ูุฏู ุงุฏูู ฺฉู ุชุงุจุน ุงฺฉุดู ุงุฒ ุขู ูุฑุงุฎูุงู ูโุดูุฏ.)</p>
</li>
<li>
<p><strong>request:</strong> ุฏุฑุฎูุงุณุช HTTP ฺฉู ุงุฒ ุณูุช ฺฉูุงูุช (ฺฉุงุฑุจุฑ) ุจู ุณุฑูุฑ ุงุฑุณุงู ุดุฏู ุงุณุช ู ุจุงุนุซ ูุดูุฏ ฺฉู ุงฺฉุดู ูุนุงู ุดูุฏ.</p>
</li>
<li>
<p><strong>queryset:</strong> ูุฌููุนูโุง ุงุฒ ุงุดุงุก ฺฉู ฺฉุงุฑุจุฑ ุฏุฑ ูพูู ุงุฏูู ุงูุชุฎุงุจ ฺฉุฑุฏู ุงุณุช.(ุฏุฑ ุงู ุงฺฉุดูุ ุณูุงุฑุด ูุง ฺฉู ุงุฏูู ุฏุฑ <strong>ูพูู ุงุฏูู</strong> ุงูุชุฎุงุจ ฺฉุฑุฏู ุงุณุช ุชุง ุจู ุตูุฑุช ุงฺฉุณู ุฎุฑูุฌ ุฏุงุฏู ุดููุฏ.)</p>
</li>
</ul>
<p>2- <strong>ุงุฌุงุฏ ูพุงุณุฎ ุจุฑุง ุฏุงูููุฏ</strong>:</p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">)</span>

<span class="n">response</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=&quot;orders.xlsx&quot;&#39;</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<ul>
<li>
<p><strong>ฺฉูุงุณ HttpResponse:</strong> ฺฉูุงุณ ูพุงุณุฎโุฏู ุฏุฑ ุฌูฺฏู ุงุณุช ฺฉู ุฏุฑ ุงูุฌุง ุจุฑุง ุงุฌุงุฏ ูุงู Excel ุงุณุชูุงุฏู ุดุฏู ุงุณุช.</p>
<blockquote>
<p><strong>HttpResponse:</strong> ุดุฆ ฺฉู ุจุฑุง ุงุฑุณุงู ุฏุงุฏูโูุง ุจู ูุฑูุฑฺฏุฑ (ฺฉูุงูุช) ุงุณุชูุงุฏู ูโุดูุฏ.</p>
</blockquote>
</li>
<li>
<p><strong>ุขุฑฺฏููุงู content_type:</strong> ููุน ูุญุชูุง ูุงู ุฑุง ูุดุฎุต ูโฺฉูุฏ ฺฉู ุงูุฌุง ุจู ุนููุงู ฺฉ ูุงู ุงฺฉุณู ุชูุธู ุดุฏู ุงุณุช.</p>
<blockquote>
<p><span class="rtl-text">ููุน ูุญุชูุง ู ุฏุงุฏู ุฑุง ูุดุฎุต ูฺฉูุฏ. / ุจู ุตูุฑุช ุฒุฑ ูุดุงู ุฏุงุฏู ูุดูุฏ. ุจุง ูุซุงู</span></p>
<p><span class="en-text">type/subtype(format) =&gt; image/jpg</span></p>
</blockquote>
</li>
</ul>
<p>ุจุฑุง ูุชุบุฑ <strong>response</strong> ุจุงุฏ ููุฏุงุฑ ูุฏุฑ <strong>Content-Disposition</strong> ุฑุง ุชุบุฑ ุฏูู.</p>
<ul>
<li>
<p><strong>Content-Disposition:</strong> ุจู ูุฑูุฑฺฏุฑ ูโฺฏูุฏ ฺฉู ูพุงุณุฎ ุจุงุฏ ุจู ุตูุฑุช ฺฉ ูุงู ุถููู ุจุง ูุงู "orders.xlsx" ุจุงุดุฏ (ูู ุจู ุนููุงู ูุญุชูุง ฺฉ ุตูุญู ูุจ).</p>
<blockquote>
<p><strong>Content-Disposition:</strong> ูุฏุฑ HTTP ฺฉู ูุดุฎุต ูโฺฉูุฏ ฺฺฏููู ูุญุชูุง ูพุงุณุฎ ุจุงุฏ ูพุฑุฏุงุฒุด ุดูุฏุ ูุซูุงู ุจู ุนููุงู ฺฉ ูุงู ูุงุจู ุฏุงูููุฏ.</p>
<p><strong>attachment:</strong> ูุดุฎุต ูฺฉูุฏ ฺฉู ฺฉู ูพุงุณุฎ ูุง ุจุงุฏ ุจู ุนููุงู ฺฉ ูุงู ุถููู ุจุฑุง ุฏุงูููุฏ ุจุงุดุฏ.</p>
<p><strong>filename:</strong> ุงุณู ูุงู ุฎุฑูุฌ ุจู ููุฑุงู ูพุณููุฏ ุขู ูุจุงุดุฏ.</p>
</blockquote>
</li>
</ul>
<p><strong><em>ุฎุจ ุญุงูุง ุจุฑู ุณุฑุงุบ ุณุงุฎุช ูุงู ุงฺฉุณู:</em></strong></p>
<p>3- <strong>ุงุฌุงุฏ ูุงู Excel ุจุง OpenPyXL</strong>:</p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="n">ws</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Orders&#39;</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<ul>
<li>
<p><span class="rtl-text"><code>openpyxl.Workbook()</code>: Workbook ุฏุฑูุงูุน ฺฉ ูุงู ุงฺฉุณู ูุจุงุดุฏ ฺฉู ูุชูุงูู ฺูุฏ sheet ุจุฑุงุด ูุดุฎุต ฺฉูู. / ูพุณ ุจุง ุงู ุฏุณุชูุฑ ฺฉ ูุงู ุงฺฉุณู ุงุฌุงุฏ ูฺฉูู.</span></p>
</li>
<li>
<p><span class="rtl-text"><code>wb.active</code>: ุจุฑฺฏู (Sheet) ูุนุงู ุฏุฑ ูุงู ุงฺฉุณู ุฑุง ูโฺฏุฑุฏ.</span></p>
</li>
<li>
<p><span class="rtl-text"><code>ws.title = 'Orders'</code>: ุนููุงู ุจุฑฺฏู ุงฺฉุณู ุฑุง ุจู "Orders" ุชุบุฑ ูโุฏูุฏ.</span></p>
<blockquote>
<p>ุงุชุฑุจูุช title ุนููุงู sheet ูุนุงู ุฑุง ุชุบุฑ ูุฏูุฏ.</p>
</blockquote>
</li>
</ul>
<p>4- <strong>ุงุฌุงุฏ ู ุงูุฒูุฏู ุนููุงู ุณุชููโูุง</strong>:</p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;First Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Last Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Phone&#39;</span><span class="p">,</span> <span class="s1">&#39;Address&#39;</span><span class="p">,</span> <span class="s1">&#39;Postal Code&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="s1">&#39;Province&#39;</span><span class="p">,</span> <span class="s1">&#39;Paid&#39;</span><span class="p">,</span> <span class="s1">&#39;Created&#39;</span><span class="p">]</span>
<span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<ul>
<li>
<p>ุงุณู ุณุชูู ูุง ฺฉู ูุฑุงุฑู ุฏุฑ ุงฺฉุณู ููุงุด ุฏุงุฏู ุดููุฏ ุฑุง ุฏุฑ ฺฉ ูุณุช ูุดุฎุต ูฺฉูู.</p>
</li>
<li>
<p>ุจุง ูุชุฏ append ุงู ูุณุช ุฑุง ุจู sheet ูุนุงู ุฏุฑ ูุงู ุงฺฉุณู ุงุถุงูู ูฺฉูู.</p>
</li>
</ul>
<p>5- <strong>ุงูุฒูุฏู ุฏุงุฏูโูุง ุณูุงุฑุดุงุช ุจู ุงฺฉุณู</strong>:</p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">:</span>
    <span class="n">created</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">created</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">created</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">order</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">firstname</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">lastname</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">phone</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">postal_code</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">city</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">province</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">paid</span><span class="p">,</span> <span class="n">created</span><span class="p">]</span>

    <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<ul>
<li>
<p><strong>ูฺฉุชู:</strong> ููุดู ููุทูู ุฒูุงู ุฑุง ุฏุฑ ุงฺฉุณู ุฐุฎุฑู ฺฉุฑุฏ(ุงุฑูุฑ ูุฏูุฏ)ุ ุจูุงุจุฑุงู ุจุงุฏ ููุทูู ุฒูุงู(time zone)ุ ุฑุง ุงุฒ ุชุงุฑุฎ ุญุฐู ฺฉูู.</p>
<blockquote>
<p>ุจุฑุง ุงู ฺฉุงุฑุ ุจุฑุง ูุฑ ุณูุงุฑุด ุชุงุฑุฎ ุงุฌุงุฏ ุฑุง ุตุฏุง ุฒุฏู ู tzinfo (ูุฎูู timezone info) ุฑุง None ูฺฉูู./ ุจุฑุง ุงุญุชุงุท ุดุฑุท ูฺฏุฐุงุฑู ฺฉู ุงฺฏุฑ ุชุงุฑุฎ ูุฌูุฏ ุฏุงุดุชุ ููุทูู ุฒูุงู ุฑุง ูพุงฺฉ ฺฉู ุชุง ุงุฑูุฑ ูุฏูุฏ.</p>
</blockquote>
</li>
<li>
<p>ุฏุฑ ุญููู for ุจุงุฏ ูุฑ ุจุงุฑุ ุจุฑุง ุณุชูู ูุง ฺฉู ุงุฌุงุฏ ฺฉุฑุฏู ุจู ููุงู ุชุฑุชุจุ ููุงุฏุฑ ุฑุง ุงุฒ ุณูุงุฑุด ุฏุฑุงูุช ฺฉุฑุฏู ู ุขููุง ุฑุง ุจู ุนููุงู ฺฉ ุฑุฏู ุจู ุงฺฉุณู ุงุถุงูู ฺฉูู.</p>
<blockquote>
<p>ุจุฑุง ุชุงุฑุฎ ุงุฌุงุฏ ุงุฒ ูุชุบุฑ ฺฉู ุงุฌุงุฏ ฺฉุฑุฏู ุงุณุชูุงุฏู ูฺฉูู. / ุชุง ููุทูู ุฒูุงู ูุฏุงุดุชู ุจุงุดุฏ.</p>
</blockquote>
</li>
</ul>
<p>6- <strong>ุฐุฎุฑู ฺฉุฑุฏู ูุงู ุงฺฉุณู ุฏุฑ ูพุงุณุฎ</strong>:</p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="k">return</span> <span class="n">response</span>
</pre></div>

<p><strong>ุชูุถุญุงุช:</strong></p>
<ul>
<li>
<p><span class="rtl-text"><code>wb.save(response)</code>: ูุงู ุงฺฉุณู ุฏุฑ ุดุก ูพุงุณุฎ HTTP ุฐุฎุฑู ูโุดูุฏ.</span></p>
<blockquote>
<p>ุจุนุฏ ุงุฒ ุญููู for  ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ saveุ ุงุทูุงุนุงุช ุฑุง ุฐุฎุฑู ูฺฉููุ ุจุฑุง ุงูฺฉู ุงู ูุงู ุงฺฉุณู ุฏุฑ ูุชุบุฑ response ุฐุฎุฑู ุดูุฏุ ุฏุงุฎู ูพุฑุงูุชุฒูุง ูุชุฏ save ุนุจุงุฑุช response ุฑุง ูููุณู.</p>
</blockquote>
</li>
<li>
<p><span class="rtl-text"><code>return response</code>: ูพุงุณุฎ ุจู ฺฉุงุฑุจุฑ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ ฺฉู ุจุงุนุซ ุฏุงูููุฏ ูุงู ุงฺฉุณู ุฎูุงูุฏ ุดุฏ.</span></p>
</li>
</ul>
<p>7- ุฏุฑ ููุงุช ูุชูุงูู ุจุฑุง ุงฺฉุดู ฺฉ ุงุณู ุฏูุฎูุงู  ูุณุชุนุงุฑ ูุดุฎุต ูู ุชุง ุฏุฑ ูพูู ุงุฏูู ููุงุด ุฏุงุฏู ุดูุฏ.</p>
<p><strong>ูุนุฑู ุงฺฉุดู ุจู ูุฏู ุงุฏูู Order:</strong></p>
<p><code>app directory(orders)/admin.py</code></p>
<div class="code-box">
        <div class="code-info">
            <button class="copy-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" class="icon-sm"><path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path></svg>
                <span>Copy code</span>
            </button>
            <span class="language">python</span>
        </div>
    <pre><span></span><span class="nd">@admin</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Order</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">OrderAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;buyer&#39;</span><span class="p">,</span> <span class="s1">&#39;firstname&#39;</span><span class="p">,</span> <span class="s1">&#39;lastname&#39;</span><span class="p">,</span> <span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;province&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;paid&#39;</span><span class="p">)</span>
    <span class="n">list_filter</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;paid&#39;</span><span class="p">,</span> <span class="s1">&#39;created&#39;</span><span class="p">,</span> <span class="s1">&#39;update&#39;</span><span class="p">)</span>
    <span class="n">list_display_links</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;firstname&#39;</span><span class="p">]</span>
    <span class="n">inlines</span> <span class="o">=</span> <span class="p">[</span><span class="n">OrdersItemInline</span><span class="p">]</span>
    <span class="c1"># ูุนุฑู ุงฺฉุดู ุจู ูุฏู ุงุฏูู:</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">export_to_excel</span><span class="p">]</span>
</pre></div>

<hr>

<h4>ุงุตุทูุงุญุงุช ฺฉูุฏ:</h4>
<p>ูุฎูุงูู ุฏุฑ ููุฑุฏ "HttpResponse", "content_type", ู "MIME-type" ฺฉุณุฑ ุชูุถุญุงุช ุงุถุงูู ุชุฑ ุจุงู ฺฉูู.(ุฌูุช ุฏุฑฺฉ ุจุดุชุฑ)</p>
<p><strong>1- HttpResponse</strong></p>
<p><strong>ุชูุถุญ:</strong></p>
<p><strong>HttpResponse:</strong> ฺฉ ฺฉูุงุณ ุฏุฑ ูุฑููุฑฺฉ ุฌูฺฏู ุงุณุช ฺฉู ุจุฑุง ุงุฑุณุงู ูพุงุณุฎ HTTP ุงุฒ ุณูุช ุณุฑูุฑ ุจู ฺฉูุงูุช ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ฺฉูุงุณ ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุชุง ูุญุชูุง ูพุงุณุฎุ ูุฏุฑูุงุ ู ฺฉุฏ ูุถุนุช HTTP ุฑุง ุชูุธู ฺฉูุฏ.</p>
<blockquote>
<p>ุจู ุนุจุงุฑุชุ ูุฑ ุฒูุงู ฺฉู ฺฉ ุฏุฑุฎูุงุณุช ุจู ุณุฑูุฑ ุงุฑุณุงู ูโุดูุฏุ ุณุฑูุฑ ุจุงุฏ ูพุงุณุฎ ุฑุง ุจุฑฺฏุฑุฏุงูุฏ. ุงู ูพุงุณุฎ ูโุชูุงูุฏ ฺฉ ุตูุญู HTMLุ ฺฉ ูุงูุ ุง ูุฑ ููุน ุฏุงุฏู ุฏฺฏุฑ ุจุงุดุฏ.</p>
</blockquote>
<p><strong>2- content_type</strong></p>
<p><strong>ุชูุถุญ:</strong></p>
<p><strong>content_type</strong> ฺฉ ูฺฺฏ ุงุฒ ุดุก <strong>HttpResponse</strong> ุงุณุช ฺฉู ููุน ูุญุชูุง ุฏุงุฏูโุง ฺฉู ุฏุฑ ูพุงุณุฎ ุงุฑุณุงู ูโุดูุฏ ุฑุง ูุดุฎุต ูโฺฉูุฏ. ุงู ููุน ูุญุชูุง ุจุง ุงุณุชูุงุฏู ุงุฒ MIME-type ูุดุฎุต ูโุดูุฏ ู ุจู ูุฑูุฑฺฏุฑ ูโฺฏูุฏ ฺฉู ฺฺฏููู ุจุงุฏ ุฏุงุฏูโูุง ุฏุฑุงูุชโุดุฏู ุฑุง ูพุฑุฏุงุฒุด ฺฉูุฏ.</p>
<p><strong>3- MIME-type</strong></p>
<p><strong>ุชูุถุญ:</strong></p>
<p>MIME-type (Multipurpose Internet Mail Extensions) ููุน ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ูุดุฎุต ฺฉุฑุฏู ููุน ูุญุชูุง ุฏุงุฏูโูุง ุฏุฑ ุงูุชุฑูุช ุงุณุช. ุงู ููุน ุงุทูุงุนุงุช ุจู ูุฑูุฑฺฏุฑ ุง ุณุงุฑ ุจุฑูุงููโูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุจุฏุงููุฏ ฺฺฏููู ุฏุงุฏูโูุง ุฑุง ูพุฑุฏุงุฒุด ฺฉููุฏ ู ุขูุฑุง ููุงุด ุฏููุฏ.</p>
<p><span class="rtl-text"><strong>ูุฑูุช ุงุณุชุงูุฏุงุฑุฏ MIME ุจู ุดฺฉู <code>type/subtype</code> ุงุณุช ู ูุฑ ุจุฎุด ุขู ุชูุถุญโุฏููุฏูโ ููุน ู ุฒุฑููุน ูุญุชูุง ุฏุงุฏูโูุงุณุช.</strong></span></p>
<ul>
<li>
<p><strong>type</strong> (ููุน): ุฏุณุชูโุจูุฏ ฺฉู ูุญุชูุง ุฑุง ูุดุฎุต ูโฺฉูุฏุ ูุงููุฏ "text"ุ "image"ุ "application"ุ "audio"ุ "video" ู ุบุฑู.</p>
</li>
<li>
<p><strong>subtype</strong> (ุฒุฑููุน): ููุน ุฎุงุตโุชุฑ ุงุฒ ูุญุชูุง ุฑุง ุฏุฑ ุขู ุฏุณุชูโุจูุฏ ูุดุฎุต ูโฺฉูุฏ. ุจุฑุง ูุซุงูุ ุฏุฑ ุฏุณุชูโุจูุฏ "text"ุ ุฒุฑููุน ูโุชูุงูุฏ "html"ุ "plain" ู ... ุจุงุดุฏ.</p>
</li>
</ul>
<p>ุจุฑู ุชู ฺฉ ูุซุงู ุจูุชุฑ ุงู ููุงูู ุฑุง ุฏุฑฺฉ ฺฉูู.</p>
<p>ุฏุฑ ูุซุงู <strong>text/plain</strong>:</p>
<ul>
<li>
<p><span class="rtl-text"><strong>type</strong>: <code>text</code></span></p>
</li>
<li>
<p><span class="rtl-text"><strong>subtype</strong>: <code>plain</code></span></p>
</li>
<li>
<p><strong>ฺฉุงุฑุจุฑุฏ</strong>: ุจุฑุง ุงุฑุณุงู ูุชู ุณุงุฏู ุจุฏูู ูุงูุจโุจูุฏ.</p>
</li>
</ul>
<p><strong>ุณุงุฑ ูุซุงูโูุง:</strong></p>
<ul>
<li>
<p><strong>text/plain:</strong> ุจุฑุง ูุงูโูุง ูุชู ุณุงุฏู</p>
</li>
<li>
<p><strong>image/jpeg:</strong> ุจุฑุง ุชุตุงูุฑ JPEG</p>
</li>
<li>
<p><strong>application/json:</strong> ุจุฑุง ุฏุงุฏูโูุง JSON</p>
</li>
<li>
<p><strong>application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:</strong> ุจุฑุง ูุงูโูุง ุงฺฉุณู (xlsx)</p>
</li>
</ul>
<p><strong><em>ุฌูุนโ ุจูุฏ:</em></strong></p>
<ul>
<li>
<p><strong>HttpResponse</strong>: ฺฉูุงุณ ูพุงุณุฎโุฏู ุฏุฑ ุฌูฺฏู ุจุฑุง ุงุฑุณุงู ุฏุงุฏูโูุง ุจู ฺฉุงุฑุจุฑ.</p>
</li>
<li>
<p><strong>content_type</strong>: ููุน ูุญุชูุง ุงุฑุณุงู ุฏุฑ ูพุงุณุฎ ฺฉู ูุญููโ ูพุฑุฏุงุฒุด ุขู ุฑุง ุจุฑุง ูุฑูุฑฺฏุฑ ูุดุฎุต ูโฺฉูุฏ.</p>
</li>
<li>
<p><strong>MIME-type</strong>: ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ุชุนู ููุน ุฏุงุฏูโูุง ฺฉู ุจู ูุฑูุฑฺฏุฑ ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุฏุงุฏูโูุง ุฑุง ุจู ุฏุฑุณุช ููุงุด ุง ูพุฑุฏุงุฒุด ฺฉูุฏ. </p>
</li>
</ul>
<h3 id="tmrynt-fsl-11-mhm">ุชูุฑูุงุช ูุตู 11 (ููู)</h3>
            <a href="https://github.com/mahd25/Django-E-booklet/edit/seasons-source/Django-E-booklet-seasons-source/season-11.md" target="_blank" class="edit-icon">
                <i class="fa-solid fa-pen-to-square"></i>
            </a>
        </div>
    </div>
</main>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://mahd25.github.io/assets/JS/Django-seasons.js"></script>
<script src="https://mahd25.github.io/assets/JS/copy-icon.js"></script>
<script src="https://mahd25.github.io/assets/JS/Footer-Copyright.js"></script>
</body>
</html>
